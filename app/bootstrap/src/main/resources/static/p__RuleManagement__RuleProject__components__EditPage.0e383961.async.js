(self.webpackChunk=self.webpackChunk||[]).push([[9998],{82826:function(ge,Z,t){"use strict";t.d(Z,{Z:function(){return i}});var f=t(87462),d=t(62435),L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},M=L,_=t(84089),o=function(A,O){return d.createElement(_.Z,(0,f.Z)({},A,{ref:O,icon:M}))},se=d.forwardRef(o),i=se},58638:function(ge,Z,t){"use strict";t.d(Z,{Z:function(){return i}});var f=t(87462),d=t(62435),L={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},M=L,_=t(84089),o=function(A,O){return d.createElement(_.Z,(0,f.Z)({},A,{ref:O,icon:M}))},se=d.forwardRef(o),i=se},86615:function(ge,Z,t){"use strict";var f=t(1413),d=t(91),L=t(22270),M=t(78045),_=t(62435),o=t(90789),se=t(58055),i=t(86074),c=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],A=_.forwardRef(function(h,H){var R=h.fieldProps,S=h.options,b=h.radioType,m=h.layout,C=h.proFieldProps,N=h.valueEnum,le=(0,d.Z)(h,c);return(0,i.jsx)(se.Z,(0,f.Z)((0,f.Z)({valueType:b==="button"?"radioButton":"radio",ref:H,valueEnum:(0,L.h)(N,void 0)},le),{},{fieldProps:(0,f.Z)({options:S,layout:m},R),proFieldProps:C,filedConfig:{customLightMode:!0}}))}),O=_.forwardRef(function(h,H){var R=h.fieldProps,S=h.children;return(0,i.jsx)(M.ZP,(0,f.Z)((0,f.Z)({},R),{},{ref:H,children:S}))}),G=(0,o.G)(O,{valuePropName:"checked",ignoreWidth:!0}),$=G;$.Group=A,$.Button=M.ZP.Button,$.displayName="ProFormComponent",Z.Z=$},91618:function(ge,Z,t){"use strict";t.d(Z,{Z:function(){return He}});var f=t(62435),d=Object.defineProperty,L=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,o=(j,p,r)=>p in j?d(j,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):j[p]=r,se=(j,p)=>{for(var r in p||(p={}))M.call(p,r)&&o(j,r,p[r]);if(L)for(var r of L(p))_.call(p,r)&&o(j,r,p[r]);return j};const i=j=>React.createElement("svg",se({width:8,height:8,xmlns:"http://www.w3.org/2000/svg"},j),React.createElement("title",null,"\u5931\u8D25"),React.createElement("path",{d:"M4 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm-.81 2.784a.287.287 0 1 0-.406.405l.81.811-.81.81a.287.287 0 1 0 .405.406L4 4.406l.81.81a.287.287 0 1 0 .406-.405L4.406 4l.81-.81a.287.287 0 1 0-.405-.406L4 3.594l-.81-.81Z",fill:"#FF3931",fillRule:"nonzero"}));var c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik00IDBhNCA0IDAgMSAxIDAgOCA0IDQgMCAwIDEgMC04Wm0tLjgxIDIuNzg0YS4yODcuMjg3IDAgMSAwLS40MDYuNDA1bC44MS44MTEtLjgxLjgxYS4yODcuMjg3IDAgMSAwIC40MDUuNDA2TDQgNC40MDZsLjgxLjgxYS4yODcuMjg3IDAgMSAwIC40MDYtLjQwNUw0LjQwNiA0bC44MS0uODFhLjI4Ny4yODcgMCAxIDAtLjQwNS0uNDA2TDQgMy41OTRsLS44MS0uODFaIiBmaWxsPSIjRkYzOTMxIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4=",A=Object.defineProperty,O=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,h=(j,p,r)=>p in j?A(j,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):j[p]=r,H=(j,p)=>{for(var r in p||(p={}))G.call(p,r)&&h(j,r,p[r]);if(O)for(var r of O(p))$.call(p,r)&&h(j,r,p[r]);return j};const R=j=>React.createElement("svg",H({width:8,height:8,xmlns:"http://www.w3.org/2000/svg"},j),React.createElement("title",null,"\u901A\u8FC7"),React.createElement("path",{d:"M4 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm1.712 2.788a.3.3 0 0 0-.424 0L3.502 4.576l-.79-.787a.3.3 0 0 0-.424.425l1.003.999a.3.3 0 0 0 .424-.001l1.997-2a.3.3 0 0 0 0-.424Z",fill:"#379E0E",fillRule:"nonzero"}));var S="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik00IDBhNCA0IDAgMSAxIDAgOCA0IDQgMCAwIDEgMC04Wm0xLjcxMiAyLjc4OGEuMy4zIDAgMCAwLS40MjQgMEwzLjUwMiA0LjU3NmwtLjc5LS43ODdhLjMuMyAwIDAgMC0uNDI0LjQyNWwxLjAwMy45OTlhLjMuMyAwIDAgMCAuNDI0LS4wMDFsMS45OTctMmEuMy4zIDAgMCAwIDAtLjQyNFoiIGZpbGw9IiMzNzlFMEUiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvc3ZnPg==",b=Object.defineProperty,m=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,le=(j,p,r)=>p in j?b(j,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):j[p]=r,K=(j,p)=>{for(var r in p||(p={}))C.call(p,r)&&le(j,r,p[r]);if(m)for(var r of m(p))N.call(p,r)&&le(j,r,p[r]);return j};const be=j=>React.createElement("svg",K({width:8,height:8,xmlns:"http://www.w3.org/2000/svg"},j),React.createElement("title",null,"\u5F85\u64CD\u4F5C"),React.createElement("g",{fillRule:"nonzero",fill:"none"},React.createElement("path",{d:"M4 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z",fill:"#FFB310"}),React.createElement("path",{d:"M3.775 2.412a.287.287 0 1 0-.573 0v1.71c0 .316.257.573.573.573h1.718a.287.287 0 1 0 0-.573H3.775v-1.71Z",fill:"#FFF1D4"})));var $e="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PHBhdGggZD0iTTQgMGE0IDQgMCAxIDEgMCA4IDQgNCAwIDAgMSAwLThaIiBmaWxsPSIjRkZCMzEwIi8+PHBhdGggZD0iTTMuNzc1IDIuNDEyYS4yODcuMjg3IDAgMSAwLS41NzMgMHYxLjcxYzAgLjMxNi4yNTcuNTczLjU3My41NzNoMS43MThhLjI4Ny4yODcgMCAxIDAgMC0uNTczSDMuNzc1di0xLjcxWiIgZmlsbD0iI0ZGRjFENCIvPjwvZz48L3N2Zz4=",X=t(66309),ye=t(53846),je=t(86074),He=function(j){var p=j.state,r=(0,je.jsx)(X.Z,{children:p||"-"});return["success","valid"].includes(p)?r=(0,je.jsxs)(X.Z,{className:ye.Z.validTag,children:[(0,je.jsx)("img",{src:S,alt:"VALID_ICON",className:ye.Z.imgResult}),"Valid"]}):["error","invalid","failed"].includes(p)?r=(0,je.jsxs)(X.Z,{className:ye.Z.invalidTag,children:[(0,je.jsx)("img",{src:c,alt:"VALID_ICON",className:ye.Z.imgResult}),"Invalid"]}):["waiting","wait"].includes(p)&&(r=(0,je.jsxs)(X.Z,{className:ye.Z.waitingTag,children:[(0,je.jsx)("img",{src:$e,alt:"WAITING_ICON",className:ye.Z.imgProcess}),"Waiting"]})),r}},24163:function(ge,Z,t){"use strict";var f=t(97857),d=t.n(f),L=t(25593),M=t(83062),_=t(62435),o=t(86074),se=L.Z.Paragraph;Z.Z=function(i){var c=i.text,A=i.width,O=i.maxWidth,G=i.rows,$=G===void 0?2:G,h=i.placement,H=h===void 0?"top":h,R=i.color,S=R===void 0?"rgba(0, 0, 0, 0.88)":R,b=i.link,m=b===void 0?!1:b,C=i.onClickCallBackFunc,N=i.style,le=N===void 0?{}:N,K=i.copyable,be=K===void 0?!1:K;return(0,o.jsx)("div",{style:{maxWidth:O,width:A},children:(0,o.jsx)(M.Z,{title:(0,o.jsx)("div",{children:c}),placement:H,children:(0,o.jsx)(se,{ellipsis:{rows:$},style:d()({marginBottom:0,color:S,cursor:m?"pointer":""},le),onClick:C,copyable:be,children:c})})})}},52078:function(ge,Z,t){"use strict";var f=t(97857),d=t.n(f),L=t(27997),M=t(62435),_=t(86074),o=function(i){L.Mj.register({id:"json"});var c=i.value,A=c===void 0?"{}":c,O=i.onChange,G=i.editorStyle,$=G===void 0?{}:G,h=i.editorKey,H=h===void 0?"json-editor":h,R=i.readOnly,S=R===void 0?!1:R,b=(0,M.useRef)(),m=(0,M.useRef)(),C=function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(le),le}catch(K){return console.warn("Invalid JSON string:",K),"{}"}};return(0,M.useEffect)(function(){if(b.current)return m.current?m.current.setValue(A):(m.current=L.j6.create(b.current,{value:C(A),language:"json",theme:"vs",readOnly:S,folding:!0,automaticLayout:!0}),m.current.onDidChangeModelContent(function(){var N=m.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:N}),O==null||O(N)})),function(){if(m!=null&&m.current){var N;m==null||(N=m.current)===null||N===void 0||N.dispose(),m.current=null}}},[]),(0,M.useEffect)(function(){m.current&&A!==m.current.getValue()&&m.current.setValue(C(A))},[A]),(0,_.jsx)("div",{ref:b,style:d()({height:360,borderRadius:4,overflow:"hidden"},$)},H)};Z.Z=o},29297:function(ge,Z,t){"use strict";t.d(Z,{q9:function(){return f.Z},Wy:function(){return i},mi:function(){return G}});var f=t(52078),d=t(97857),L=t.n(d),M=t(55171),_=t.n(M),o=t(86074),se=function(h){var H=h.value,R=h.viewerStyle,S=R===void 0?{}:R,b=h.displayDataTypes,m=b===void 0?!1:b,C=h.name,N=C===void 0?"output json":C;return(0,o.jsx)(_(),{src:H,name:N,collapsed:!1,displayDataTypes:m,style:L()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},S)})},i=se,c=t(27997),A=t(62435),O=function(h){c.Mj.register({id:"rego"});var H=h.value,R=h.onChange,S=h.editorStyle,b=S===void 0?{}:S,m=h.editorKey,C=h.readOnly,N=C===void 0?!1:C,le=(0,A.useRef)(),K=(0,A.useRef)();return(0,A.useEffect)(function(){if(le.current)return K.current||(K.current=c.j6.create(le.current,{value:H,language:"rego",theme:"vs",readOnly:N,automaticLayout:!0}),K.current.onDidChangeModelContent(function(){R==null||R(K.current.getValue())})),function(){if(K.current){var be;(be=K.current)===null||be===void 0||be.dispose(),K.current=null}}},[]),(0,o.jsx)("div",{ref:le,style:L()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},b)},m)},G=O},38575:function(ge,Z,t){"use strict";t.r(Z),t.d(Z,{default:function(){return Or}});var f=t(15009),d=t.n(f),L=t(99289),M=t.n(L),_=t(97857),o=t.n(_),se=t(5574),i=t.n(se),c=t(62435),A=Object.defineProperty,O=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,h=(E,u,y)=>u in E?A(E,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):E[u]=y,H=(E,u)=>{for(var y in u||(u={}))G.call(u,y)&&h(E,y,u[y]);if(O)for(var y of O(u))$.call(u,y)&&h(E,y,u[y]);return E};const R=E=>React.createElement("svg",H({width:12,height:12,xmlns:"http://www.w3.org/2000/svg"},E),React.createElement("title",null,"\u7F16\u7EC4"),React.createElement("g",{fill:"#457AFF",fillRule:"nonzero"},React.createElement("path",{d:"M7.445 11.998H1.983C.89 11.998 0 11.093 0 9.982V2.015C0 .905.89 0 1.983 0h5.129c1.093 0 1.983.904 1.983 2.015v3.943a.5.5 0 0 1-.495.503.5.5 0 0 1-.495-.503V2.015c0-.557-.445-1.008-.993-1.009H1.983c-.548 0-.992.452-.993 1.01v7.966c0 .557.445 1.009.993 1.01h5.462a.5.5 0 0 1 .495.502.5.5 0 0 1-.495.504Z"}),React.createElement("path",{d:"M6.704 3.042H2.391a.5.5 0 0 1-.495-.503.5.5 0 0 1 .495-.503h4.313a.5.5 0 0 1 .495.503.5.5 0 0 1-.495.503Zm0 1.811H2.391a.5.5 0 0 1-.495-.503.5.5 0 0 1 .495-.503h4.313a.5.5 0 0 1 .495.503.5.5 0 0 1-.495.503ZM4.543 6.664H2.39a.5.5 0 0 1-.495-.503.5.5 0 0 1 .495-.503h2.152a.5.5 0 0 1 .495.503.5.5 0 0 1-.495.503ZM7.628 8.84c0 .564.45 1.021 1.006 1.021.555 0 1.005-.457 1.005-1.022 0-.564-.45-1.021-1.005-1.021-.556 0-1.006.457-1.006 1.021Z"}),React.createElement("path",{d:"M9.61 12H7.61c-.497 0-.956-.27-1.205-.707l-1-1.759a1.438 1.438 0 0 1 0-1.414l1-1.758c.25-.437.708-.706 1.205-.707H9.61c.497 0 .956.27 1.205.707l1 1.758c.247.437.247.976 0 1.414l-1 1.76c-.25.436-.708.705-1.205.706ZM7.61 6.661a.402.402 0 0 0-.347.205l-1 1.757a.415.415 0 0 0 0 .408l1 1.759a.402.402 0 0 0 .347.204H9.61a.401.401 0 0 0 .347-.204l1-1.759a.415.415 0 0 0 0-.408l-1-1.757a.401.401 0 0 0-.347-.204L7.61 6.66Z"})));var S="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzQ1N0FGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNNy40NDUgMTEuOTk4SDEuOTgzQy44OSAxMS45OTggMCAxMS4wOTMgMCA5Ljk4MlYyLjAxNUMwIC45MDUuODkgMCAxLjk4MyAwaDUuMTI5YzEuMDkzIDAgMS45ODMuOTA0IDEuOTgzIDIuMDE1djMuOTQzYS41LjUgMCAwIDEtLjQ5NS41MDMuNS41IDAgMCAxLS40OTUtLjUwM1YyLjAxNWMwLS41NTctLjQ0NS0xLjAwOC0uOTkzLTEuMDA5SDEuOTgzYy0uNTQ4IDAtLjk5Mi40NTItLjk5MyAxLjAxdjcuOTY2YzAgLjU1Ny40NDUgMS4wMDkuOTkzIDEuMDFoNS40NjJhLjUuNSAwIDAgMSAuNDk1LjUwMi41LjUgMCAwIDEtLjQ5NS41MDRaIi8+PHBhdGggZD0iTTYuNzA0IDMuMDQySDIuMzkxYS41LjUgMCAwIDEtLjQ5NS0uNTAzLjUuNSAwIDAgMSAuNDk1LS41MDNoNC4zMTNhLjUuNSAwIDAgMSAuNDk1LjUwMy41LjUgMCAwIDEtLjQ5NS41MDNabTAgMS44MTFIMi4zOTFhLjUuNSAwIDAgMS0uNDk1LS41MDMuNS41IDAgMCAxIC40OTUtLjUwM2g0LjMxM2EuNS41IDAgMCAxIC40OTUuNTAzLjUuNSAwIDAgMS0uNDk1LjUwM1pNNC41NDMgNi42NjRIMi4zOWEuNS41IDAgMCAxLS40OTUtLjUwMy41LjUgMCAwIDEgLjQ5NS0uNTAzaDIuMTUyYS41LjUgMCAwIDEgLjQ5NS41MDMuNS41IDAgMCAxLS40OTUuNTAzWk03LjYyOCA4Ljg0YzAgLjU2NC40NSAxLjAyMSAxLjAwNiAxLjAyMS41NTUgMCAxLjAwNS0uNDU3IDEuMDA1LTEuMDIyIDAtLjU2NC0uNDUtMS4wMjEtMS4wMDUtMS4wMjEtLjU1NiAwLTEuMDA2LjQ1Ny0xLjAwNiAxLjAyMVoiLz48cGF0aCBkPSJNOS42MSAxMkg3LjYxYy0uNDk3IDAtLjk1Ni0uMjctMS4yMDUtLjcwN2wtMS0xLjc1OWExLjQzOCAxLjQzOCAwIDAgMSAwLTEuNDE0bDEtMS43NThjLjI1LS40MzcuNzA4LS43MDYgMS4yMDUtLjcwN0g5LjYxYy40OTcgMCAuOTU2LjI3IDEuMjA1LjcwN2wxIDEuNzU4Yy4yNDcuNDM3LjI0Ny45NzYgMCAxLjQxNGwtMSAxLjc2Yy0uMjUuNDM2LS43MDguNzA1LTEuMjA1LjcwNlpNNy42MSA2LjY2MWEuNDAyLjQwMiAwIDAgMC0uMzQ3LjIwNWwtMSAxLjc1N2EuNDE1LjQxNSAwIDAgMCAwIC40MDhsMSAxLjc1OWEuNDAyLjQwMiAwIDAgMCAuMzQ3LjIwNEg5LjYxYS40MDEuNDAxIDAgMCAwIC4zNDctLjIwNGwxLTEuNzU5YS40MTUuNDE1IDAgMCAwIDAtLjQwOGwtMS0xLjc1N2EuNDAxLjQwMSAwIDAgMC0uMzQ3LS4yMDRMNy42MSA2LjY2WiIvPjwvZz48L3N2Zz4=",b=Object.defineProperty,m=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,le=(E,u,y)=>u in E?b(E,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):E[u]=y,K=(E,u)=>{for(var y in u||(u={}))C.call(u,y)&&le(E,y,u[y]);if(m)for(var y of m(u))N.call(u,y)&&le(E,y,u[y]);return E};const be=E=>React.createElement("svg",K({width:12,height:14,xmlns:"http://www.w3.org/2000/svg"},E),React.createElement("title",null,"\u7F16\u7EC4"),React.createElement("g",{fill:"#FFF",fillRule:"evenodd"},React.createElement("path",{d:"M7.545 0a2.56 2.56 0 0 1 2.56 2.56l.001 4.122a4.072 4.072 0 0 0-3.15-.003A4.143 4.143 0 0 0 4.5 11.307a4.136 4.136 0 0 0 1.064 2.056H2.56A2.56 2.56 0 0 1 0 10.804V2.56A2.56 2.56 0 0 1 2.56 0h4.985ZM6.511 3.127 5.794 4.61 4.36 3.868a.455.455 0 0 0-.62.214L2.818 5.99a.491.491 0 0 0 .02.464c.084.141.233.227.393.227a.46.46 0 0 0 .413-.264l.717-1.482 1.433.74a.455.455 0 0 0 .62-.213l.922-1.909a.485.485 0 0 0-.208-.636.454.454 0 0 0-.617.21Z"}),React.createElement("path",{d:"M11.415 8.556a3.52 3.52 0 0 1-.432 4.419A3.438 3.438 0 0 1 8.527 14a3.48 3.48 0 0 1-3.407-2.817 3.505 3.505 0 0 1 2.077-3.916 3.459 3.459 0 0 1 4.218 1.289Zm-3.502.691a.25.25 0 0 0-.13.22v2.066a.247.247 0 0 0 .386.208l1.536-1.033a.25.25 0 0 0 0-.416L8.168 9.26a.247.247 0 0 0-.255-.012Z",fillRule:"nonzero"})));var $e="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI0ZGRiIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNy41NDUgMGEyLjU2IDIuNTYgMCAwIDEgMi41NiAyLjU2bC4wMDEgNC4xMjJhNC4wNzIgNC4wNzIgMCAwIDAtMy4xNS0uMDAzQTQuMTQzIDQuMTQzIDAgMCAwIDQuNSAxMS4zMDdhNC4xMzYgNC4xMzYgMCAwIDAgMS4wNjQgMi4wNTZIMi41NkEyLjU2IDIuNTYgMCAwIDEgMCAxMC44MDRWMi41NkEyLjU2IDIuNTYgMCAwIDEgMi41NiAwaDQuOTg1Wk02LjUxMSAzLjEyNyA1Ljc5NCA0LjYxIDQuMzYgMy44NjhhLjQ1NS40NTUgMCAwIDAtLjYyLjIxNEwyLjgxOCA1Ljk5YS40OTEuNDkxIDAgMCAwIC4wMi40NjRjLjA4NC4xNDEuMjMzLjIyNy4zOTMuMjI3YS40Ni40NiAwIDAgMCAuNDEzLS4yNjRsLjcxNy0xLjQ4MiAxLjQzMy43NGEuNDU1LjQ1NSAwIDAgMCAuNjItLjIxM2wuOTIyLTEuOTA5YS40ODUuNDg1IDAgMCAwLS4yMDgtLjYzNi40NTQuNDU0IDAgMCAwLS42MTcuMjFaIi8+PHBhdGggZD0iTTExLjQxNSA4LjU1NmEzLjUyIDMuNTIgMCAwIDEtLjQzMiA0LjQxOUEzLjQzOCAzLjQzOCAwIDAgMSA4LjUyNyAxNGEzLjQ4IDMuNDggMCAwIDEtMy40MDctMi44MTcgMy41MDUgMy41MDUgMCAwIDEgMi4wNzctMy45MTYgMy40NTkgMy40NTkgMCAwIDEgNC4yMTggMS4yODlabS0zLjUwMi42OTFhLjI1LjI1IDAgMCAwLS4xMy4yMnYyLjA2NmEuMjQ3LjI0NyAwIDAgMCAuMzg2LjIwOGwxLjUzNi0xLjAzM2EuMjUuMjUgMCAwIDAgMC0uNDE2TDguMTY4IDkuMjZhLjI0Ny4yNDcgMCAwIDAtLjI1NS0uMDEyWiIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==",X=Object.defineProperty,ye=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable,j=(E,u,y)=>u in E?X(E,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):E[u]=y,p=(E,u)=>{for(var y in u||(u={}))je.call(u,y)&&j(E,y,u[y]);if(ye)for(var y of ye(u))He.call(u,y)&&j(E,y,u[y]);return E};const r=E=>React.createElement("svg",p({width:12,height:12,xmlns:"http://www.w3.org/2000/svg"},E),React.createElement("title",null,"\u5173\u8054"),React.createElement("g",{fill:"#457AFF",fillRule:"nonzero"},React.createElement("path",{d:"M8.25 7.507V5.953a.477.477 0 1 0-.956 0v1.341H.956V.956h6.338v1.31a.477.477 0 1 0 .956 0V.744A.744.744 0 0 0 7.507 0H.743A.744.744 0 0 0 0 .743v6.764c0 .41.333.743.743.743h6.764c.41 0 .743-.333.743-.743Z"}),React.createElement("path",{d:"M11.257 3.75H4.493a.744.744 0 0 0-.743.743V6.06a.478.478 0 1 0 .956 0V4.706h6.338v6.34H4.706V9.68a.478.478 0 1 0-.956 0v1.576c0 .41.333.743.743.743h6.764c.41 0 .743-.333.743-.743V4.493a.744.744 0 0 0-.743-.743Z"})));var w="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzQ1N0FGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOC4yNSA3LjUwN1Y1Ljk1M2EuNDc3LjQ3NyAwIDEgMC0uOTU2IDB2MS4zNDFILjk1NlYuOTU2aDYuMzM4djEuMzFhLjQ3Ny40NzcgMCAxIDAgLjk1NiAwVi43NDRBLjc0NC43NDQgMCAwIDAgNy41MDcgMEguNzQzQS43NDQuNzQ0IDAgMCAwIDAgLjc0M3Y2Ljc2NGMwIC40MS4zMzMuNzQzLjc0My43NDNoNi43NjRjLjQxIDAgLjc0My0uMzMzLjc0My0uNzQzWiIvPjxwYXRoIGQ9Ik0xMS4yNTcgMy43NUg0LjQ5M2EuNzQ0Ljc0NCAwIDAgMC0uNzQzLjc0M1Y2LjA2YS40NzguNDc4IDAgMSAwIC45NTYgMFY0LjcwNmg2LjMzOHY2LjM0SDQuNzA2VjkuNjhhLjQ3OC40NzggMCAxIDAtLjk1NiAwdjEuNTc2YzAgLjQxLjMzMy43NDMuNzQzLjc0M2g2Ljc2NGMuNDEgMCAuNzQzLS4zMzMuNzQzLS43NDNWNC40OTNhLjc0NC43NDQgMCAwIDAtLjc0My0uNzQzWiIvPjwvZz48L3N2Zz4=",U=t(91618),v=t(24163),I=t(29297),Me=t(13769),ve=t.n(Me),oe=t(58638),Q=t(97269),Y=t(93410),ie=t(50727),D=t(45830),fe=t(3303),V=t(85265),B=t(86250),P=t(83622),Ze=t(42075),re=t(96486),e=t(86074),pt=["idx","map_row_parentKey"],ht=fe.Z.SHOW_CHILD,lt=[{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.only.associate.once"}),value:"\u4EC5\u5173\u8054\u4E00\u6B21"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.related.multiple.times"}),value:"\u5173\u8054\u591A\u6B21"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.no.associated.fields"}),value:"\u65E0\u5173\u8054\u5B57\u6BB5"}],Et=function(u){var y=u.linkDrawerVisible,Ke=u.setLinkDrawerVisible,Ue=u.linkFormRef,dt=u.resourceTypeList,et=u.form,tt=u.formData,Le=u.setFormData,ue=(0,D.useIntl)(),Ae=(0,c.useRef)(),Ye=(0,c.useState)([]),Re=i()(Ye,2),rt=Re[0],Je=Re[1],ct=(0,c.useRef)(),q=function(){var ae;(ae=Ue.current)===null||ae===void 0||ae.resetFields()},s=function(){Ke(!1)},mt=function(ae){var ee=(0,re.cloneDeep)(ae)||{},te=ee.linkedDataList;if(Array.isArray(te)&&!(0,re.isEmpty)(te)){var pe=te.map(function(Te){var ze=Te.idx,Pe=Te.map_row_parentKey,gt=ve()(Te,pt);return o()({},gt)});ee.linkedDataList=pe}return ee},Xe=function(ae){var ee=(0,re.cloneDeep)(ae)||{},te=ee,pe=[];if(Array.isArray(te)&&!(0,re.isEmpty)(te)){var Te=te==null?void 0:te.map(function(ze,Pe){return pe.push(Pe),o()(o()({},ze),{},{idx:Pe})});ee.linkedDataList=Te}return ee.editableKeyList=pe,ee},we=function(){var de=M()(d()().mark(function ae(){var ee;return d()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:(ee=Ue.current)===null||ee===void 0||ee.validateFields().then(function(Te){var ze,Pe=((ze=mt(Te))===null||ze===void 0?void 0:ze.linkedDataList)||[];et.setFieldValue("linkedDataList",Pe),Le(o()(o()({},tt),{},{linkedDataList:Pe})),s()});case 1:case"end":return pe.stop()}},ae)}));return function(){return de.apply(this,arguments)}}();(0,c.useEffect)(function(){if(y){var de=et.getFieldValue("linkedDataList"),ae=Xe(de),ee=ae.linkedDataList,te=ae.editableKeyList;if(!(0,re.isEmpty)(ee)&&!(0,re.isEmpty)(te)){var pe;(pe=Ue.current)===null||pe===void 0||pe.setFieldsValue({linkedDataList:ee}),Je(te)}}else q()},[y]);var at=[{title:ue.formatMessage({id:"involve.extend.title.serial.number"}),dataIndex:"id",editable:!1,width:60,align:"center",render:function(ae,ee,te){return te+1}},{title:ue.formatMessage({id:"rule.module.text.associative.mode"}),width:200,dataIndex:"associativeMode",formItemProps:{rules:[{required:!1}]},valueType:"select",fieldProps:{options:lt,multiple:!1,allowClear:!0,showSearch:!0}},{title:ue.formatMessage({id:"rule.module.text.main.asset.associated.fields"}),dataIndex:"linkedKey1",formItemProps:{rules:[{required:!1}]}},{title:ue.formatMessage({id:"rule.module.text.related.asset.type"}),width:200,dataIndex:"resourceType",formItemProps:{rules:[{required:!0}]},valueType:"cascader",fieldProps:{options:dt,multiple:!1,allowClear:!0,showSearch:!0,showCheckedStrategy:ht}},{title:ue.formatMessage({id:"rule.module.text.associated.assets.associated.fields"}),dataIndex:"linkedKey2",formItemProps:{rules:[{required:!1}]}},{title:ue.formatMessage({id:"rule.module.text.mount.field.name"}),dataIndex:"newKeyName",formItemProps:{rules:[{required:!0}]}},{title:ue.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),valueType:"option",width:140,render:function(){return[]}}];return(0,e.jsx)(V.Z,{title:(0,e.jsxs)(B.Z,{align:"center",children:[(0,e.jsx)("span",{style:{marginRight:4},children:ue.formatMessage({id:"rule.module.text.related.assets"})}),(0,e.jsxs)(P.ZP,{size:"small",type:"link",href:"https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/apka69usk9a3gf1s#jLQrz",target:"_blank",style:{color:"#2f54eb",gap:4},children:[(0,e.jsx)(oe.Z,{}),(0,e.jsx)("span",{children:ue.formatMessage({id:"common.link.text.help.center"})})]})]}),onClose:s,destroyOnClose:!0,open:y,width:"80%",footer:(0,e.jsx)(B.Z,{justify:"flex-end",children:(0,e.jsxs)(Ze.Z,{children:[(0,e.jsx)(P.ZP,{onClick:function(){return s()},children:ue.formatMessage({id:"common.button.text.cancel"})}),(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return we()},children:ue.formatMessage({id:"common.button.text.ok"})})]})}),children:(0,e.jsx)(Q.A,{formRef:Ue,layout:"horizontal",submitter:!1,children:(0,e.jsx)(Y.Z,{bodyStyle:{backgroundColor:"rgb(245, 245, 245)",padding:"0 20px 16px 20px"},children:(0,e.jsx)(ie.Z,{rowKey:"idx",name:"linkedDataList",actionRef:Ae,editableFormRef:ct,headerTitle:(0,e.jsx)("div",{style:{fontSize:14},children:ue.formatMessage({id:"involve.extend.title.conditional.config"})}),recordCreatorProps:{creatorButtonText:ue.formatMessage({id:"involve.extend.title.addRowConfig"}),record:function(){return{idx:(Math.random()*1e6).toFixed(0)}}},columns:at,editable:{type:"multiple",editableKeys:rt,onChange:Je,actionRender:function(ae,ee,te){return[te.delete]}}})})})})},De=Et,St=t(94032),ke=t(96655),Nt=t(61713),wt=t(90498),ot=t(68872),Tt=function(u){var y=u.variableDrawerVisible,Ke=u.setVariableDrawerVisible,Ue=u.variableDrawerInfo,dt=Ue===void 0?{}:Ue,et=u.requestRuleDetailById,tt=u.selectedRowKeys,Le=tt===void 0?[]:tt,ue=u.setSelectedRowKeys,Ae=u.formData,Ye=u.setCurrent,Re=dt.id,rt=ot.ZP.useMessage(),Je=i()(rt,2),ct=Je[0],q=Je[1],s=(0,D.useIntl)(),mt=(0,c.useState)(!1),Xe=i()(mt,2),we=Xe[0],at=Xe[1],de=function(){Ke(!1),ue((Ae==null?void 0:Ae.globalVariableConfigIdList)||[])},ae=function(){de()},ee=function(){var me=M()(d()().mark(function W(){var J,he;return d()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(!Re){ce.next=15;break}return at(!0),J={id:Re,globalVariableConfigIdList:Le,resourceType:Ae==null?void 0:Ae.resourceType,ruleTypeIdList:Ae.ruleTypeIdList},ce.next=5,(0,ke.saveRule)(J);case 5:if(he=ce.sent,at(!1),!(he.msg==="success"||[200].includes(he.code))){ce.next=13;break}return ct.success(s.formatMessage({id:"common.message.text.batch.add.success"})),ce.next=11,et(Re);case 11:Ye(1),Ke(!1);case 13:ce.next=16;break;case 15:Ke(!1);case 16:case"end":return ce.stop()}},W)}));return function(){return me.apply(this,arguments)}}(),te=function(){var me=M()(d()().mark(function W(){return d()().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:de();case 1:case"end":return he.stop()}},W)}));return function(){return me.apply(this,arguments)}}(),pe=(0,c.useRef)(),Te=[{title:s.formatMessage({id:"cloudAccount.extend.title.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(W,J){return(0,e.jsxs)("div",{children:[(0,e.jsx)("section",{children:(J==null?void 0:J.gmtCreate)||"-"}),(0,e.jsx)("section",{children:(J==null?void 0:J.gmtModified)||"-"})]})}},{title:s.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",align:"left",width:200,hideInSearch:!0},{title:s.formatMessage({id:"rule.module.text.variable.name"}),dataIndex:"name",valueType:"text",align:"left",width:150},{title:s.formatMessage({id:"rule.module.text.variable.path"}),dataIndex:"path",valueType:"text",align:"center"},{title:s.formatMessage({id:"rule.module.text.reference.rules"}),dataIndex:"ruleNameList",key:"ruleNameList",hideInSearch:!0,render:function(W,J){var he;return(0,e.jsx)("ul",{style:{paddingInlineStart:16},children:J==null||(he=J.ruleNameList)===null||he===void 0?void 0:he.map(function(We,ce){return(0,e.jsx)("li",{children:We},ce)})})}}],ze=function(){var me=M()(d()().mark(function W(J){var he,We,ce,vt,jt,nt,Ee,ft;return d()().wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return he=J.name,We=J.path,ce=J.current,vt=J.pageSize,jt={name:he,path:We,page:ce,size:vt},Ve.next=4,(0,Nt.listGlobalVariableConfig)(jt);case 4:return nt=Ve.sent,Ee=nt.content,ft=nt.code,Ve.abrupt("return",{data:(Ee==null?void 0:Ee.data)||[],total:(Ee==null?void 0:Ee.total)||0,success:ft===200||!1});case 8:case"end":return Ve.stop()}},W)}));return function(J){return me.apply(this,arguments)}}(),Pe=function(W){ue(W)},gt={selectedRowKeys:Le,onChange:Pe,preserveSelectedRowKeys:!0};return(0,e.jsxs)(V.Z,{footer:(0,e.jsx)(B.Z,{style:{width:"100%"},justify:"end",children:(0,e.jsxs)(Ze.Z,{children:[(0,e.jsx)(P.ZP,{type:"dashed",onClick:function(){return te()},children:s.formatMessage({id:"common.button.text.cancel"})}),(0,e.jsx)(P.ZP,{loading:we,type:"primary",onClick:function(){return ee()},children:s.formatMessage({id:"common.button.text.save"})})]})}),title:s.formatMessage({id:"rule.extend.text.variable.information"}),width:"64%",destroyOnClose:!0,open:y,onClose:ae,styles:{body:{padding:8}},children:[q,(0,e.jsx)(wt.Z,{scroll:{x:!0},options:!1,rowKey:"id",columns:Te,actionRef:pe,request:ze,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},search:{labelWidth:s.locale==="en-US"?110:80},rowSelection:gt,expandable:{expandRowByClick:!0,expandedRowRender:function(W){return(0,e.jsx)(Y.Z,{direction:"column",gutter:[0,16],children:!(0,re.isEmpty)(W==null?void 0:W.data)&&(0,e.jsxs)(Y.Z,{ghost:!0,children:[(0,e.jsx)("p",{children:s.formatMessage({id:"rule.module.text.variable.value"})}),(0,e.jsx)(I.mi,{readOnly:!0,editorKey:"dataEditor",value:W==null?void 0:W.data,editorStyle:{height:"280px",maxHeight:"280px"}})]})})},rowExpandable:function(W){return!(0,re.isEmpty)(W==null?void 0:W.data)}}})]})},bt=Tt,xt=`package example

import rego.v1

# Use [input] to get the value from the input data, such as "input.object.field1".

# Use [risk] flag to determine whether it is a risk, When [risk] is true, it is judged as a risk.

default risk = false

# When a user requests a private resource using GET, it is considered a risk.

risk if {
    input.method == "GET"
    input.path == "/private/resource"
}

# When an admin uses GET to request access, it is considered a risk.

risk if {
    input.method == "GET"
    input.path == "/admin/resource"
    input.user.role == "admin"
}

### For more details please see: https://www.openpolicyagent.org/docs/latest/#example`,Ot="\u5B9E\u4F8B\uFF1A{$.ResourceId} \uFF0C\u540D\u79F0\uFF1A{$.ResourceName} \u5B58\u5728\u98CE\u9669\u3002",Mt=t(92635),Be=t(10736),Rt=t(79930),_e=t(17910),Ce=t(29448),it=t(70607),Cr=t(82826),Ir=t(39380),Pt=t(97462),Lr=t(86615),Gt=t(90672),Ar=t(5966),Er=t(25593),Ie=t(23323),Sr=t(17788),$t=t(55241),Ht=t(38703),ut=t(71230),Fe=t(15746),Nr=t(42119),wr=t(78045),Zt=t(25278),yt=t(34041),Tr=t(83062),_t=t(85137),Oe=t(61194),zt=Er.Z.Title,Kt=fe.Z.SHOW_CHILD,Ne=[{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.example.data"}),value:"INPUT"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.appoint.tenant"}),value:"TENANT"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.appoint.cloud.platform"}),value:"CLOUD_ACCOUNT"}],Yt=0,br=function(){var u,y=(0,D.useModel)("tenant"),Ke=y.tenantListAdded,Ue=(0,D.useLocation)(),dt=new URLSearchParams(Ue.search),et=(0,c.useState)(dt.get("id")),tt=i()(et,1),Le=tt[0],ue=(0,it.a)({}),Ae=(0,D.useModel)("rule"),Ye=Ae.platformList,Re=Ae.ruleGroupList,rt=Ae.ruleTypeList,Je=Ie.Z.useForm(),ct=i()(Je,1),q=ct[0],s=(0,D.useIntl)(),mt=ot.ZP.useMessage(),Xe=i()(mt,2),we=Xe[0],at=Xe[1],de=Sr.Z.useModal(),ae=i()(de,2),ee=ae[0],te=ae[1],pe=(0,c.useState)(!1),Te=i()(pe,2),ze=Te[0],Pe=Te[1],gt=(0,c.useState)({}),me=i()(gt,2),W=me[0],J=me[1],he=(0,c.useState)([]),We=i()(he,2),ce=We[0],vt=We[1],jt=(0,c.useState)(xt),nt=i()(jt,2),Ee=nt[0],ft=nt[1],Jt=(0,c.useState)(""),Ve=i()(Jt,2),Dt=Ve[0],kt=Ve[1],Rr=(0,c.useState)({}),Xt=i()(Rr,2),Pr=Xt[0],Ft=Xt[1],Zr=(0,c.useState)(!1),qt=i()(Zr,2),_r=qt[0],er=qt[1],tr=(0,c.useRef)({}),zr=(0,c.useState)(!1),rr=i()(zr,2),kr=rr[0],ar=rr[1],nr=(0,c.useRef)({}),Fr=(0,c.useState)([]),sr=i()(Fr,2),Ut=sr[0],lr=sr[1],Ur=(0,c.useState)({}),or=i()(Ur,2),k=or[0],Ct=or[1],Qe=(0,c.useRef)("waiting"),Vr=(0,c.useState)(!1),ir=i()(Vr,2),Br=ir[0],ur=ir[1],Wr=(0,c.useState)(!1),dr=i()(Wr,2),Qr=dr[0],cr=dr[1],Gr=(0,c.useRef)(),$r=(0,c.useState)(Yt),mr=i()($r,2),Hr=mr[0],gr=mr[1],st=(0,c.useRef)(null),Kr=(0,c.useState)(!1),vr=i()(Kr,2),Yr=vr[0],fr=vr[1],Jr=function(){tr.current={ruleId:Le},er(!0)},Xr=function(){nr.current=o()({},W),ar(!0)},qr=function(a){ft(a),Qe.current="",qe(k)},ea=function(a){kt(a)},ta=(0,D.useRequest)(function(g){return(0,Rt.queryGroupTypeList)({platformList:[g]})},{manual:!0,formatResult:function(a){var n=a.content;return vt(n||[]),n}}),pr=ta.run,hr=(0,D.useRequest)(function(g){return(0,ke.queryResourceExampleData)(g)},{formatResult:function(a){if(a.msg==="success"){var n=a.content;try{kt(JSON.stringify(n,null,4)||"")}catch(x){console.info("Error",x)}}},manual:!0}),ra=hr.run,aa=hr.loading,na=(0,c.useState)([{title:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.basic.info"}),description:(0,e.jsx)(e.Fragment,{})},{title:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.rule.development"}),description:(0,e.jsx)(e.Fragment,{})},{title:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.repair.suggestions.title"}),description:(0,e.jsx)(e.Fragment,{})}]),xr=i()(na,2),It=xr[0],sa=xr[1],la=(0,c.useState)(0),Mr=i()(la,2),xe=Mr[0],Lt=Mr[1],qe=function(a,n){var x=It.map(function(l,F){if(F===0){var ne;return o()(o()({},l),{},{description:(0,e.jsx)($t.Z,{content:(0,e.jsxs)("div",{style:{padding:"2px 6px"},children:[(0,e.jsxs)(B.Z,{style:{marginBottom:7},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"common.select.label.cloudPlatform"}),"\xA0:\xA0"]}),(0,e.jsx)("span",{style:{color:"rgb(48, 48, 48)"},children:(0,Ce.fD)(a==null?void 0:a.platform,Ye)})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"cloudAccount.extend.title.asset.type"}),"\xA0:\xA0"]}),(0,e.jsx)("span",{style:{color:"rgb(48, 48, 48)"},children:(0,Ce.xF)(n||ce,a==null?void 0:a.resourceType)||"-"})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"home.module.inform.columns.ruleName"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.ruleName)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.rule.describe"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.ruleDesc)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"layout.routes.title.ruleGroup"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(Re==null||(ne=Re.filter(function(z){var Ge;return a==null||(Ge=a.ruleGroupIdList)===null||Ge===void 0?void 0:Ge.includes(z==null?void 0:z.value)}).map(function(z){return z==null?void 0:z.label}))===null||ne===void 0?void 0:ne.toString())||"-",maxWidth:100,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(0,Ce.S1)(rt,a==null?void 0:a.ruleTypeIdList)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(B.Z,{style:{marginTop:7},align:"center",children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"home.module.inform.columns.riskLevel"}),"\xA0:\xA0"]}),(0,Ce.Uf)(_e.I9,a.riskLevel)]})]}),children:(0,e.jsxs)(B.Z,{style:{margin:"6px 0"},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"common.table.columns.platform"}),"\xA0:\xA0"]}),(0,e.jsx)("span",{style:{color:"rgb(48, 48, 48)"},children:(0,Ce.fD)(a==null?void 0:a.platform,Ye)})]})})})}else return F===1?o()(o()({},l),{},{description:(0,e.jsx)("div",{children:Qe.current&&(0,e.jsxs)(B.Z,{style:{marginTop:6},align:"center",children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.running.results"}),"\xA0:\xA0"]}),(0,e.jsx)(U.Z,{state:Qe.current})]})})}):F===2?o()(o()({},l),{},{description:(0,e.jsx)($t.Z,{placement:"bottom",content:(0,e.jsxs)("div",{style:{padding:"2px 6px"},children:[(0,e.jsxs)(B.Z,{style:{marginBottom:7},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.repair.suggestions"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.advice)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.reference.link"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.link)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(B.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.risk.context.template"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.context)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]})]}),children:(0,e.jsxs)(B.Z,{style:{margin:"6px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.repair.suggestions"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.advice)||"-",maxWidth:180,rows:1,color:xe===2?"rgba(0, 0, 0, 0.88)":"rgba(0, 0, 0, 0.45)"})]})})}):o()({},l)});sa(x)},oa=(0,D.useRequest)(function(g){return(0,ke.queryAnalysisProgress)({taskId:g})},{formatResult:function(a){var n,x;if((a==null||(n=a.content)===null||n===void 0?void 0:n.percent)===1){var l;Qe.current="success",Ft(JSON.parse(a==null||(l=a.content)===null||l===void 0?void 0:l.result)||{}),qe(k)}return a==null||(x=a.content)===null||x===void 0?void 0:x.percent},onSuccess:function(a){gr(a)},manual:!0}),ia=oa.run,ua=(0,D.useRequest)(function(g){return(0,ke.queryCancelTask)({taskId:g})},{onSuccess:function(){return we.warning(s.formatMessage({id:"rule.message.text.task.cancelled"}))},manual:!0}),yr=ua.run,da=function(a){var n=ee.info({title:s.formatMessage({id:"common.message.text.execute.loading"}),content:(0,e.jsx)(B.Z,{style:{width:"100"},justify:"center",children:(0,e.jsx)(Ht.Z,{type:"circle",percent:Number((0,Ce.x9)(Hr*100,2)),size:80})}),closable:!0,destroyOnClose:!0,footer:(0,e.jsx)(e.Fragment,{}),onCancel:function(){st.current&&clearTimeout(st.current),yr(a)}});st.current=setInterval(M()(d()().mark(function x(){var l,F;return d()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,ia(a);case 2:l=z.sent,n.update({title:s.formatMessage({id:"common.message.text.execute.loading"}),content:(0,e.jsx)(B.Z,{style:{width:"100"},justify:"center",children:(0,e.jsx)(Ht.Z,{type:"circle",percent:Number((0,Ce.x9)(l*100,2)),size:80})}),closable:!0,destroyOnClose:!0,footer:(0,e.jsx)(e.Fragment,{}),onCancel:function(){st.current&&clearTimeout(st.current),yr(a)}}),l===1&&(clearInterval(st.current),F=setTimeout(function(){clearTimeout(F),gr(Yt),n.destroy()},800));case 5:case"end":return z.stop()}},x)})),1e3)},ca=function(){var g=M()(d()().mark(function a(){var n,x,l,F,ne,z,Ge,At,Se,Wt,Qt;return d()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(n={},x=q.getFieldValue("type"),x!==Ne[0].value){T.next=42;break}if(l=q.getFieldValue("instanceId"),n.ruleRego=Ee,n.globalVariableConfigIdList=Ut,n.linkedDataList=(k==null?void 0:k.linkedDataList)||[],!l){T.next=38;break}return T.prev=8,F={platform:q.getFieldValue("platform"),resourceType:q.getFieldValue("resourceType"),linkedDataList:(k==null?void 0:k.linkedDataList)||[],resourceId:l},T.next=12,(0,ke.queryResourceExampleData)(F);case 12:if(ne=T.sent,ne.msg!=="success"){T.next=29;break}return z=ne.content,T.prev=15,Ge=JSON.stringify(z,null,4)||"",kt(Ge),n.input=Ge,T.next=21,new Promise(function(ya){return setTimeout(ya,2e3)});case 21:T.next=27;break;case 23:T.prev=23,T.t0=T.catch(15),console.info("Error processing input data:",T.t0),n.input=Dt;case 27:T.next=30;break;case 29:n.input=Dt;case 30:T.next=36;break;case 32:return T.prev=32,T.t1=T.catch(8),console.error("Error fetching resource example data:",T.t1),T.abrupt("return");case 36:T.next=39;break;case 38:n.input=Dt;case 39:l&&(n.instanceId=l),T.next=55;break;case 42:if(n.type=x,At=q.getFieldValue("selectId"),n.selectId=At,n.ruleRego=Ee,n.platform=q.getFieldValue("platform"),n.resourceType=(0,Ce.g2)(q.getFieldValue("resourceType")),n.linkedDataList=(k==null?void 0:k.linkedDataList)||[],!(x===Ne[1].value&&!At)){T.next=53;break}return T.abrupt("return",we.error("Please Select".concat(Ne[1].label)));case 53:if(!(x===Ne[2].value&&!At)){T.next=55;break}return T.abrupt("return",we.error("Please Select".concat(Ne[2].label)));case 55:return fr(!0),T.next=58,(0,Be.evaluateRego)(n);case 58:Se=T.sent,fr(!1),x===Ne[0].value?Se.code===200&&Se.msg==="success"?(we.success(s.formatMessage({id:"common.message.text.execute.success"})),Ft((Se==null||(Wt=Se.content)===null||Wt===void 0?void 0:Wt.result)||{}),Qe.current="success",qe(k)):(Se.code!==200||Se.msg!=="success")&&(Ft(Se||{}),Qe.current="error",qe(k)):Se!=null&&(Qt=Se.content)!==null&&Qt!==void 0&&Qt.taskId&&da(Se.content.taskId);case 61:case"end":return T.stop()}},a,null,[[8,32],[15,23]])}));return function(){return g.apply(this,arguments)}}(),ma=function(a,n){Ct(o()(o()({},k),n)),qe(o()(o()({},k),n))},ga=function(){Lt(function(a){return a-1})},va=function(){q.validateFields().then(function(){var a=M()(d()().mark(function n(x){return d()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(xe!==0){F.next=5;break}return F.next=3,ra({platform:x==null?void 0:x.platform,resourceType:x==null?void 0:x.resourceType,linkedDataList:(x==null?void 0:x.linkedDataList)||[]});case 3:F.next=10;break;case 5:if(xe!==1){F.next=10;break}if(!(0,re.isEmpty)(Ee)){F.next=8;break}return F.abrupt("return",we.error(s.formatMessage({id:"rule.message.text.rego.noEmpty"})));case 8:if(Qe.current==="success"){F.next=10;break}return F.abrupt("return",we.error(s.formatMessage({id:"rule.message.text.rego.noPass"})));case 10:Lt(function(ne){return ne+1});case 11:case"end":return F.stop()}},n)}));return function(n){return a.apply(this,arguments)}}())};(0,c.useEffect)(function(){(0,re.isEmpty)(k)||qe(k)},[xe]);var fa=function(){q.validateFields().then(function(){var a=M()(d()().mark(function n(x){var l,F;return d()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Pe(!0),l=o()(o()({},k),{},{ruleRego:Ee,globalVariableConfigIdList:Ut,context:x==null?void 0:x.context}),Le&&(l.id=Le),l==null||delete l.type,l==null||delete l.selectId,l==null||delete l.ruleGroupList,z.next=8,(0,ke.saveRule)(l);case 8:F=z.sent,Pe(!1),(F.msg==="success"||[200].includes(F.code))&&(Le?we.success(s.formatMessage({id:"common.message.text.edit.success"})):we.success(s.formatMessage({id:"common.message.text.create.success"})),D.history.push("/ruleManagement/ruleProject?tab=market"));case 11:case"end":return z.stop()}},n)}));return function(n){return a.apply(this,arguments)}}())},pa=function(){var g=M()(d()().mark(function a(n){var x,l;return d()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:(0,re.isEmpty)(n)||(lr((n==null?void 0:n.globalVariableConfigIdList)||[]),Lt(0),Qe.current="success",l=o()(o()({},n),{},{ruleGroupIdList:n==null||(x=n.ruleGroupList)===null||x===void 0?void 0:x.map(function(z){return z==null?void 0:z.id})}),Ct(l),q.setFieldsValue(l),ft((n==null?void 0:n.ruleRego)||""),n!=null&&n.platform&&pr(n==null?void 0:n.platform).then(function(z){qe(l,z)}).finally(function(){return ur(!1)}));case 1:case"end":return ne.stop()}},a)}));return function(n){return g.apply(this,arguments)}}(),ha=(0,D.useRequest)(function(){var g=M()(d()().mark(function a(n){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,ke.queryRuleDetail)({id:Number(n)});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},a)}));return function(a){return g.apply(this,arguments)}}(),{formatResult:function(){var g=M()(d()().mark(function n(x){var l;return d()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return l=x.content,J(l),ne.next=4,pa(l);case 4:case"end":return ne.stop()}},n)}));function a(n){return g.apply(this,arguments)}return a}(),manual:!0}),Vt=ha.run;(0,c.useEffect)(function(){Le&&(ur(!0),Vt(Le))},[Le]);var xa=function(){cr(!0)},jr=(0,D.useRequest)(function(g){return(0,Mt.cloudAccountBaseInfoListV2)(o()({},g))},{manual:!0,formatResult:function(a){return a==null?void 0:a.content}}),Bt=jr.data,Ma=jr.run,Dr=(0,re.debounce)(function(g){var a=q.getFieldValue("platform"),n=[];a&&n.push(a),Ma({platformList:n,cloudAccountSearch:g})},500);return(0,e.jsxs)(Ir._z,{ghost:!0,breadcrumbRender:!1,header:{ghost:!0},title:(0,e.jsxs)(P.ZP,{type:"link",size:"small",onClick:function(){return D.history===null||D.history===void 0?void 0:D.history.back()},children:[(0,e.jsx)(Cr.Z,{}),s.formatMessage({id:"common.button.text.return"})]}),className:xe===1?Oe.Z.ruleEditPageContainerSpecial:Oe.Z.ruleEditPageContainer,footer:[(0,e.jsxs)(Ze.Z,{style:{paddingRight:8},children:[xe>0&&(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return ga()},children:s.formatMessage({id:"common.button.text.pre"})}),xe<It.length-1&&(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return va()},loading:aa,children:s.formatMessage({id:"common.button.text.next"})}),xe===It.length-1&&(0,e.jsx)(P.ZP,{loading:ze,type:"primary",onClick:function(){return fa()},children:s.formatMessage({id:"common.button.text.submit"})})]},"buttonList")],loading:Br,children:[at,te,(0,e.jsx)(ut.Z,{style:{marginBottom:20,padding:xe===1?"0 14px":"unset"},children:(0,e.jsx)(Fe.Z,{span:24,style:{minHeight:"100%"},children:(0,e.jsx)(Y.Z,{className:Oe.Z.stepListMain,children:(0,e.jsx)(Nr.Z,{size:"small",className:Oe.Z.stepsWrap,direction:"horizontal",current:xe,items:It})})})}),(0,e.jsx)(ut.Z,{style:{minHeight:"calc(100vh - 362px)"},children:(0,e.jsx)(Fe.Z,{span:24,style:{minHeight:"100%"},children:(0,e.jsx)(Y.Z,{className:xe===1?Oe.Z.contentMainTransparent:Oe.Z.contentMain,bodyStyle:{paddingTop:xe===1?0:16},children:(0,e.jsxs)(Ie.Z,{form:q,layout:"vertical",onValuesChange:(0,re.debounce)(ma,200),children:[xe===0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ie.Z.Item,{name:"platform",label:s.formatMessage({id:"home.module.overview.platform"}),rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],children:(0,e.jsx)(wr.ZP.Group,{disabled:!!Le,onChange:function(a){q.setFieldValue("resourceType",null),q.setFieldValue("linkedDataList",[]),Ct(o()(o()({},k),{},{linkedDataList:null})),vt([]),pr(a.target.value)},options:(0,Ce.T$)(Ye)})}),(0,e.jsx)(Pt.Z,{name:["platform"],children:function(a){var n=a.platform;return(0,re.isEmpty)(n)?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(Ie.Z.Item,{name:"resourceType",label:s.formatMessage({id:"cloudAccount.extend.title.asset.type"}),rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],style:{marginBottom:0},children:(0,e.jsx)(fe.Z,{options:ce,multiple:!1,placeholder:s.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:Kt,allowClear:!0,showSearch:!0})})}}),(0,e.jsx)(Pt.Z,{name:["platform"],children:function(a){var n=a.platform;return(0,re.isEmpty)(n)?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(Ie.Z.Item,{layout:"horizontal",name:"linkedDataList",label:"",style:{marginBottom:24},children:[(0,e.jsxs)(P.ZP,{type:"link",size:"small",onClick:function(){return xa()},style:{gap:4},children:[(0,e.jsx)("img",{src:w,alt:"RELATION_ICON",style:{width:14,height:14}}),s.formatMessage({id:"rule.module.text.related.assets"})]}),(k==null?void 0:k.linkedDataDesc)&&(0,e.jsx)(Ze.Z,{size:[8,16],wrap:!0,children:(0,e.jsx)("span",{style:{color:"#c5c2c2"},children:k==null?void 0:k.linkedDataDesc})})]})}}),(0,e.jsxs)(ut.Z,{gutter:[24,12],children:[(0,e.jsx)(Fe.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{name:"ruleName",label:s.formatMessage({id:"home.module.inform.columns.ruleName"}),rules:[{required:!0}],children:(0,e.jsx)(Zt.Z,{placeholder:s.formatMessage({id:"common.input.text.placeholder"})})})}),(0,e.jsx)(Fe.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{name:"ruleDesc",label:s.formatMessage({id:"rule.module.text.rule.describe"}),rules:[{required:!0}],children:(0,e.jsx)(Zt.Z,{placeholder:s.formatMessage({id:"common.input.text.placeholder"})})})}),(0,e.jsx)(Fe.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{name:"ruleGroupIdList",label:s.formatMessage({id:"layout.routes.title.ruleGroup"}),rules:[{required:!1,message:s.formatMessage({id:"common.select.text.placeholder"})}],children:(0,e.jsx)(yt.Z,{options:Re||[],placeholder:s.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,mode:"multiple"})})}),(0,e.jsx)(Fe.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{label:s.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),name:"ruleTypeIdList",rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],children:(0,e.jsx)(fe.Z,{showCheckedStrategy:Kt,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:rt||[]})})}),(0,e.jsx)(Fe.Z,{span:12,children:(0,e.jsx)(Lr.Z.Group,{name:"riskLevel",label:s.formatMessage({id:"home.module.inform.columns.riskLevel"}),rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],options:(0,Ce.at)(_e.I9)})})]})]}),xe===1&&(0,e.jsxs)("div",{children:[(0,e.jsx)(ut.Z,{children:(0,e.jsx)(B.Z,{justify:"end",style:{width:"100%"},children:(0,e.jsxs)(Ze.Z,{children:[(0,e.jsxs)(P.ZP,{href:"https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/un0z2rchy084tnww",target:"_blank",style:{gap:4,border:"1px solid #457aff",color:"#457aff",padding:"4px 10px",backgroundColor:"transparent"},children:[(0,e.jsx)("img",{src:S,style:{height:14},alt:"LINK_ICON"}),s.formatMessage({id:"rule.extend.text.config"})]}),(0,e.jsxs)(P.ZP,{type:"primary",onClick:function(){return ca()},style:{gap:4},loading:Yr,children:[(0,e.jsx)("img",{src:$e,style:{height:14},alt:"linkIcon"}),s.formatMessage({id:"rule.extend.text.execute"})]})]})})}),(0,e.jsxs)(ut.Z,{gutter:16,style:{marginTop:4},children:[(0,e.jsxs)(Fe.Z,{md:14,span:24,children:[(0,e.jsx)(zt,{level:5,className:Oe.Z.customTitle,style:{marginBottom:16},children:"The Rego PlayGround"}),(0,e.jsx)(I.mi,{editorKey:"regoEditor",value:Ee,onChange:qr,editorStyle:{height:"680px"}})]}),(0,e.jsxs)(Fe.Z,{md:10,span:24,children:[(0,e.jsx)(zt,{level:5,className:Oe.Z.customTitle,children:(0,e.jsxs)(B.Z,{align:"center",children:[(0,e.jsx)("span",{style:{marginRight:12},children:"INPUT"}),(0,e.jsxs)(Ze.Z.Compact,{children:[(0,e.jsx)(Ie.Z.Item,{name:"type",noStyle:!0,initialValue:Ne[0].value,children:(0,e.jsx)(yt.Z,{options:Ne,style:{width:114},onChange:function(a){q.setFieldValue("selectId",null),q.setFieldValue("instanceId",null),a===Ne[2].value&&Dr()}})}),(0,e.jsx)(Pt.Z,{name:["type"],children:function(a){var n=a.type,x=(0,e.jsx)(e.Fragment,{});return n===Ne[0].value?x=(0,e.jsx)(Ie.Z.Item,{name:"instanceId",noStyle:!0,children:(0,e.jsx)(Zt.Z,{placeholder:s.formatMessage({id:"rule.extend.placeholder.input"}),style:{width:160},allowClear:!0})}):n===Ne[1].value?x=(0,e.jsx)(Ie.Z.Item,{noStyle:!0,name:"selectId",children:(0,e.jsx)(yt.Z,{options:Ke||[],style:{width:160},fieldNames:{label:"tenantName",value:"id"}})}):n===Ne[2].value&&(x=(0,e.jsx)(Ie.Z.Item,{name:"selectId",noStyle:!0,children:(0,e.jsx)(yt.Z,{allowClear:!0,showSearch:!0,filterOption:!1,placeholder:s.formatMessage({id:"common.select.query.text.placeholder"}),onSearch:Dr,options:(Bt==null?void 0:Bt.map(function(l){return{label:(0,e.jsx)(Tr.Z,{placement:"topLeft",title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:l==null?void 0:l.alias}),(0,e.jsx)("div",{children:l==null?void 0:l.cloudAccountId})]}),children:(l==null?void 0:l.alias)+"/"+(l==null?void 0:l.cloudAccountId)}),value:l==null?void 0:l.cloudAccountId}}))||[],style:{width:160}})})),x}})]})]})}),(0,e.jsx)(I.q9,{editorStyle:{height:"360px"},editorKey:"inputEditor",value:Dt,onChange:ea}),(0,e.jsx)(zt,{style:{marginTop:8},level:5,className:Oe.Z.customTitle,children:"OUTPUT"}),(0,e.jsx)(I.Wy,{viewerStyle:{height:"280px"},value:Pr})]})]})]}),xe===2&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Gt.Z,{name:"advice",label:s.formatMessage({id:"rule.module.text.repair.suggestions"}),placeholder:s.formatMessage({id:"common.input.text.placeholder"})}),(0,e.jsx)(Ar.Z,{name:"link",label:s.formatMessage({id:"rule.module.text.reference.link"}),placeholder:s.formatMessage({id:"common.input.text.placeholder"}),rules:[{pattern:new RegExp("^(https?|ftp):\\/\\/[^\\s/$.?#].[^\\s]*$","i"),message:s.formatMessage({id:"common.input.text.link.check"})}]}),(0,e.jsx)(Gt.Z,{name:"context",label:s.formatMessage({id:"rule.module.text.risk.context.template"}),placeholder:Ot})]})]})})})}),xe===1&&(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(_t.Z.Group,{shape:"square",style:{insetInlineEnd:-2,top:(u=["xxLProMax","xxLFullHD","xxLPro"])!==null&&u!==void 0&&u.includes(ue)?"7vh":"36vh",boxShadow:"none"},children:[(0,e.jsx)(_t.Z,{onClick:function(){return Jr()},className:Oe.Z.floatButton,icon:(0,e.jsx)("div",{style:{fontSize:14},children:s.formatMessage({id:"rule.extend.text.history"})})}),(0,e.jsx)(_t.Z,{onClick:function(){return Xr()},className:Oe.Z.floatButton,icon:(0,e.jsx)("div",{style:{fontSize:14},children:s.formatMessage({id:"rule.extend.text.variable"})})})]})}),(0,e.jsx)(St.Z,{noteDrawerVisible:_r,setNoteDrawerVisible:er,noteDrawerInfo:tr.current,requestRuleDetailById:Vt}),(0,e.jsx)(bt,{formData:k,setCurrent:Lt,variableDrawerVisible:kr,setVariableDrawerVisible:ar,variableDrawerInfo:nr.current,requestRuleDetailById:Vt,selectedRowKeys:Ut,setSelectedRowKeys:lr}),(0,e.jsx)(De,{linkDrawerVisible:Qr,setLinkDrawerVisible:cr,linkFormRef:Gr,resourceTypeList:ce,form:q,formData:k,setFormData:Ct})]})},Or=br},94032:function(ge,Z,t){"use strict";var f=t(97857),d=t.n(f),L=t(15009),M=t.n(L),_=t(99289),o=t.n(_),se=t(5574),i=t.n(se),c=t(29297),A=t(10736),O=t(90498),G=t(93410),$=t(45830),h=t(68872),H=t(83622),R=t(85265),S=t(96486),b=t.n(S),m=t(62435),C=t(86074),N=function(K){var be=K.noteDrawerVisible,$e=K.setNoteDrawerVisible,X=K.noteDrawerInfo,ye=K.requestRuleDetailById,je=h.ZP.useMessage(),He=i()(je,2),j=He[0],p=He[1],r=(0,$.useIntl)(),w=function(){$e(!1)},U=function(){w()},v=(0,m.useRef)(),I=function(){var oe=o()(M()().mark(function Q(Y){var ie,D;return M()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return ie={ruleId:X==null?void 0:X.ruleId,isDraft:0,ruleRego:Y==null?void 0:Y.ruleRego},V.next=3,(0,A.saveRego)(ie);case 3:if(D=V.sent,!(D.code===200||D.msg==="success")){V.next=9;break}return j.success(r.formatMessage({id:"rule.message.text.version.rollback.success"})),V.next=8,ye(Number(X==null?void 0:X.ruleId));case 8:U();case 9:case"end":return V.stop()}},Q)}));return function(Y){return oe.apply(this,arguments)}}(),Me=[{title:r.formatMessage({id:"rule.module.text.version"}),dataIndex:"version",align:"center",render:function(Q){return"v"+Q}},{title:r.formatMessage({id:"rule.module.text.user.name"}),dataIndex:"userName",align:"center"},{title:r.formatMessage({id:"common.table.columns.rule.updateTime"}),dataIndex:"gmtModified",align:"center"},{title:r.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"operate",align:"center",valueType:"option",render:function(Q,Y){return(0,C.jsx)(H.ZP,{type:"link",onClick:function(){return I(Y)},children:r.formatMessage({id:"common.button.text.rollback"})})}}],ve=function(){var oe=o()(M()().mark(function Q(Y){var ie,D,fe,V;return M()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return fe={page:Y.current,size:Y.pageSize,ruleId:X==null?void 0:X.ruleId},P.next=3,(0,A.queryRegoList)(d()({},fe));case 3:return V=P.sent,P.abrupt("return",{data:(V==null||(ie=V.content)===null||ie===void 0?void 0:ie.data)||[],success:(V==null?void 0:V.code)===200||!1,total:(V==null||(D=V.content)===null||D===void 0?void 0:D.total)||0});case 5:case"end":return P.stop()}},Q)}));return function(Y){return oe.apply(this,arguments)}}();return(0,C.jsxs)(R.Z,{title:r.formatMessage({id:"rule.extend.text.historical.records"}),width:"52%",destroyOnClose:!0,open:be,onClose:U,children:[p,(0,C.jsx)(O.Z,{search:!1,scroll:{x:!0},options:!1,rowKey:"id",columns:Me,actionRef:v,request:ve,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},expandable:{expandRowByClick:!0,expandedRowRender:function(Q){return(0,C.jsx)(G.Z,{direction:"column",gutter:[0,16],children:!(0,S.isEmpty)(Q.ruleRego)&&(0,C.jsxs)(G.Z,{ghost:!0,children:[(0,C.jsx)("p",{children:r.formatMessage({id:"rule.module.text.info"})}),(0,C.jsx)(c.mi,{editorKey:"regoMsgEditor",value:Q.ruleRego,editorStyle:{height:"280px",maxHeight:"280px"}})]})})},rowExpandable:function(Q){return!(0,S.isEmpty)(Q.ruleRego)}}})]})};Z.Z=N},70607:function(ge,Z,t){"use strict";t.d(Z,{a:function(){return i}});var f=t(5574),d=t.n(f),L=t(96486),M=t.n(L),_=t(62435),o={xs:575,sm:576,md:768,lg:992,xL:1200,xxL:1600,xxLPro:1800,xxLFullHD:1920,xxLProMax:2200},se=function(A){var O=A.query,G=O===void 0?"":O,$=A.throttleTime,h=$===void 0?200:$,H=useState(!1),R=_slicedToArray(H,2),S=R[0],b=R[1],m=useCallback(throttle(function(){var C=window.matchMedia(G);b(C.matches)},h),[h]);return useEffect(function(){var C;return(C=window)===null||C===void 0||C.addEventListener("resize",m),m(),function(){var N;(N=window)===null||N===void 0||N.removeEventListener("resize",m)}},[m]),S},i=function(A){var O=A.throttleTime,G=O===void 0?200:O,$=(0,_.useState)("xxL"),h=d()($,2),H=h[0],R=h[1],S=(0,_.useCallback)((0,L.throttle)(function(){for(var b in o)if(Object.prototype.hasOwnProperty.call(o,b)){var m,C=b,N="(min-width: ".concat(o[C],"px)");C==="xs"&&(N="(max-width: ".concat(o[C],"px)")),(m=window)!==null&&m!==void 0&&(m=m.matchMedia(N))!==null&&m!==void 0&&m.matches&&R(C)}},G),[G]);return(0,_.useEffect)(function(){var b;return(b=window)===null||b===void 0||b.addEventListener("resize",S),S(),function(){var m;(m=window)===null||m===void 0||m.removeEventListener("resize",S)}},[S]),H}},53846:function(ge,Z){"use strict";Z.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(ge,Z){"use strict";Z.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},66309:function(ge,Z,t){"use strict";t.d(Z,{Z:function(){return p}});var f=t(62435),d=t(93967),L=t.n(d),M=t(98423),_=t(98787),o=t(69760),se=t(96159),i=t(45353),c=t(53124),A=t(861),O=t(15063),G=t(14747),$=t(83262),h=t(83559);const H=r=>{const{paddingXXS:w,lineWidth:U,tagPaddingHorizontal:v,componentCls:I,calc:Me}=r,ve=Me(v).sub(U).equal(),oe=Me(w).sub(U).equal();return{[I]:Object.assign(Object.assign({},(0,G.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:ve,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,A.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${I}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${I}-close-icon`]:{marginInlineStart:oe,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${I}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${I}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:ve}}),[`${I}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},R=r=>{const{lineWidth:w,fontSizeIcon:U,calc:v}=r,I=r.fontSizeSM;return(0,$.mergeToken)(r,{tagFontSize:I,tagLineHeight:(0,A.unit)(v(r.lineHeightSM).mul(I).equal()),tagIconSize:v(U).sub(v(w).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},S=r=>({defaultBg:new O.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var b=(0,h.I$)("Tag",r=>{const w=R(r);return H(w)},S),m=function(r,w){var U={};for(var v in r)Object.prototype.hasOwnProperty.call(r,v)&&w.indexOf(v)<0&&(U[v]=r[v]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,v=Object.getOwnPropertySymbols(r);I<v.length;I++)w.indexOf(v[I])<0&&Object.prototype.propertyIsEnumerable.call(r,v[I])&&(U[v[I]]=r[v[I]]);return U},N=f.forwardRef((r,w)=>{const{prefixCls:U,style:v,className:I,checked:Me,onChange:ve,onClick:oe}=r,Q=m(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:Y,tag:ie}=f.useContext(c.E_),D=re=>{ve==null||ve(!Me),oe==null||oe(re)},fe=Y("tag",U),[V,B,P]=b(fe),Ze=L()(fe,`${fe}-checkable`,{[`${fe}-checkable-checked`]:Me},ie==null?void 0:ie.className,I,B,P);return V(f.createElement("span",Object.assign({},Q,{ref:w,style:Object.assign(Object.assign({},v),ie==null?void 0:ie.style),className:Ze,onClick:D})))}),le=t(98719);const K=r=>(0,le.Z)(r,(w,{textColor:U,lightBorderColor:v,lightColor:I,darkColor:Me})=>({[`${r.componentCls}${r.componentCls}-${w}`]:{color:U,background:I,borderColor:v,"&-inverse":{color:r.colorTextLightSolid,background:Me,borderColor:Me},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var be=(0,h.bk)(["Tag","preset"],r=>{const w=R(r);return K(w)},S);function $e(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const X=(r,w,U)=>{const v=$e(U);return{[`${r.componentCls}${r.componentCls}-${w}`]:{color:r[`color${U}`],background:r[`color${v}Bg`],borderColor:r[`color${v}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var ye=(0,h.bk)(["Tag","status"],r=>{const w=R(r);return[X(w,"success","Success"),X(w,"processing","Info"),X(w,"error","Error"),X(w,"warning","Warning")]},S),je=function(r,w){var U={};for(var v in r)Object.prototype.hasOwnProperty.call(r,v)&&w.indexOf(v)<0&&(U[v]=r[v]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,v=Object.getOwnPropertySymbols(r);I<v.length;I++)w.indexOf(v[I])<0&&Object.prototype.propertyIsEnumerable.call(r,v[I])&&(U[v[I]]=r[v[I]]);return U};const j=f.forwardRef((r,w)=>{const{prefixCls:U,className:v,rootClassName:I,style:Me,children:ve,icon:oe,color:Q,onClose:Y,bordered:ie=!0,visible:D}=r,fe=je(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:V,direction:B,tag:P}=f.useContext(c.E_),[Ze,re]=f.useState(!0),e=(0,M.Z)(fe,["closeIcon","closable"]);f.useEffect(()=>{D!==void 0&&re(D)},[D]);const pt=(0,_.o2)(Q),ht=(0,_.yT)(Q),lt=pt||ht,Et=Object.assign(Object.assign({backgroundColor:Q&&!lt?Q:void 0},P==null?void 0:P.style),Me),De=V("tag",U),[St,ke,Nt]=b(De),wt=L()(De,P==null?void 0:P.className,{[`${De}-${Q}`]:lt,[`${De}-has-color`]:Q&&!lt,[`${De}-hidden`]:!Ze,[`${De}-rtl`]:B==="rtl",[`${De}-borderless`]:!ie},v,I,ke,Nt),ot=Be=>{Be.stopPropagation(),Y==null||Y(Be),!Be.defaultPrevented&&re(!1)},[,Tt]=(0,o.Z)((0,o.w)(r),(0,o.w)(P),{closable:!1,closeIconRender:Be=>{const Rt=f.createElement("span",{className:`${De}-close-icon`,onClick:ot},Be);return(0,se.wm)(Be,Rt,_e=>({onClick:Ce=>{var it;(it=_e==null?void 0:_e.onClick)===null||it===void 0||it.call(_e,Ce),ot(Ce)},className:L()(_e==null?void 0:_e.className,`${De}-close-icon`)}))}}),bt=typeof fe.onClick=="function"||ve&&ve.type==="a",xt=oe||null,Ot=xt?f.createElement(f.Fragment,null,xt,ve&&f.createElement("span",null,ve)):ve,Mt=f.createElement("span",Object.assign({},e,{ref:w,className:wt,style:Et}),Ot,Tt,pt&&f.createElement(be,{key:"preset",prefixCls:De}),ht&&f.createElement(ye,{key:"status",prefixCls:De}));return St(bt?f.createElement(i.Z,{component:"Tag"},Mt):Mt)});j.CheckableTag=N;var p=j},85674:function(ge,Z,t){var f={"./simpleWorker":18352,"./simpleWorker.js":18352};function d(L){return Promise.resolve().then(function(){if(!t.o(f,L)){var M=new Error("Cannot find module '"+L+"'");throw M.code="MODULE_NOT_FOUND",M}var _=f[L];return t(_)})}d.keys=function(){return Object.keys(f)},d.id=85674,ge.exports=d},10131:function(ge,Z,t){var f={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function d(L){if(!t.o(f,L))return Promise.resolve().then(function(){var o=new Error("Cannot find module '"+L+"'");throw o.code="MODULE_NOT_FOUND",o});var M=f[L],_=M[0];return Promise.all(M.slice(1).map(t.e)).then(function(){return t(_)})}d.keys=function(){return Object.keys(f)},d.id=10131,ge.exports=d}}]);
