(self.webpackChunk=self.webpackChunk||[]).push([[8692],{81569:function(W,P,t){"use strict";var v=t(56477),f=t(61011),d=t(86074);P.Z=function(n){var D=n.expanded,x=n.onExpand,e=n.record;return D?(0,d.jsx)(v.Z,{style:{color:"#457aff",fontSize:14},onClick:function(j){return x(e,j)}}):(0,d.jsx)(f.Z,{style:{color:"#457aff",fontSize:14},onClick:function(j){return x(e,j)}})}},52078:function(W,P,t){"use strict";var v=t(97857),f=t.n(v),d=t(27997),n=t(62435),D=t(86074),x=function(p){d.Mj.register({id:"json"});var j=p.value,E=j===void 0?"{}":j,R=p.onChange,h=p.editorStyle,J=h===void 0?{}:h,r=p.editorKey,B=r===void 0?"json-editor":r,I=p.readOnly,Z=I===void 0?!1:I,S=(0,n.useRef)(),i=(0,n.useRef)(),C=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(F),F}catch(M){return console.warn("Invalid JSON string:",M),"{}"}};return(0,n.useEffect)(function(){if(S.current)return i.current?i.current.setValue(E):(i.current=d.j6.create(S.current,{value:C(E),language:"json",theme:"vs",readOnly:Z,folding:!0,automaticLayout:!0}),i.current.onDidChangeModelContent(function(){var y=i.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:y}),R==null||R(y)})),function(){if(i!=null&&i.current){var y;i==null||(y=i.current)===null||y===void 0||y.dispose(),i.current=null}}},[]),(0,n.useEffect)(function(){i.current&&E!==i.current.getValue()&&i.current.setValue(C(E))},[E]),(0,D.jsx)("div",{ref:S,style:f()({height:360,borderRadius:4,overflow:"hidden"},J)},B)};P.Z=x},29297:function(W,P,t){"use strict";t.d(P,{q9:function(){return v.Z},Wy:function(){return p},mi:function(){return h}});var v=t(52078),f=t(97857),d=t.n(f),n=t(55171),D=t.n(n),x=t(86074),e=function(r){var B=r.value,I=r.viewerStyle,Z=I===void 0?{}:I,S=r.displayDataTypes,i=S===void 0?!1:S,C=r.name,y=C===void 0?"output json":C;return(0,x.jsx)(D(),{src:B,name:y,collapsed:!1,displayDataTypes:i,style:d()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},Z)})},p=e,j=t(27997),E=t(62435),R=function(r){j.Mj.register({id:"rego"});var B=r.value,I=r.onChange,Z=r.editorStyle,S=Z===void 0?{}:Z,i=r.editorKey,C=r.readOnly,y=C===void 0?!1:C,F=(0,E.useRef)(),M=(0,E.useRef)();return(0,E.useEffect)(function(){if(F.current)return M.current||(M.current=j.j6.create(F.current,{value:B,language:"rego",theme:"vs",readOnly:y,automaticLayout:!0}),M.current.onDidChangeModelContent(function(){I==null||I(M.current.getValue())})),function(){if(M.current){var V;(V=M.current)===null||V===void 0||V.dispose(),M.current=null}}},[]),(0,x.jsx)("div",{ref:F,style:d()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},S)},i)},h=R},96987:function(W,P,t){"use strict";t.d(P,{ym:function(){return fe},g1:function(){return he},vr:function(){return je},Uk:function(){return xe},UL:function(){return me},GD:function(){return ye}});var v=t(55375),f=t(8751),d=t(18429),n=t(45830),D=t(42075),x=t(25593),e=t(86074),p=function(U){var m=U.enable;return(0,e.jsx)(e.Fragment,{children:m?(0,e.jsxs)(D.Z,{size:4,children:[(0,e.jsx)(f.Z,{style:{color:v.qY}}),(0,e.jsx)(x.Z.Text,{children:(0,e.jsx)(n.FormattedMessage,{id:"common.tag.text.enabled"})})]}):(0,e.jsxs)(D.Z,{size:4,children:[(0,e.jsx)(d.Z,{style:{color:v.jS}}),(0,e.jsx)(x.Z.Text,{children:(0,e.jsx)(n.FormattedMessage,{id:"common.tag.text.disabled"})})]})})},j=t(21171),E=t(29448),R=t(93410),h=t(23323),J=t(71230),r=t(15746),B=t(86250),I=t(27484),Z=t.n(I),S=t(62435),i=function(){var m,u,a,s,c,g,N,L,b,O=(0,n.useLocation)(),A=new URLSearchParams(O.search),l=A.get("id"),K=(0,n.useModel)("rule"),G=K.platformList,T=(0,n.useIntl)(),k=(0,n.useRequest)(function(Q){return(0,j.queryIdentityDetailById)({id:Q})},{manual:!0,formatResult:function(Y){return Y==null?void 0:Y.content}}),Se=k.run,o=k.data,De=k.loading;return(0,S.useEffect)(function(){l&&Se(Number(l))},[l]),(0,e.jsx)(R.Z,{loading:De,title:T.formatMessage({id:"rule.module.text.basic.info"}),children:(0,e.jsx)(h.Z,{layout:"vertical",children:(0,e.jsxs)(J.Z,{children:[(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"asset.module.text.account.name"}),children:(o==null||(m=o.userInfo)===null||m===void 0?void 0:m.userName)||"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"cloudAccount.extend.title.cloud.platform"}),children:(0,e.jsx)(B.Z,{children:(0,E.fD)(o==null||(u=o.userInfo)===null||u===void 0?void 0:u.platform,G)})})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"asset.module.text.email"}),children:(o==null||(a=o.userInfo)===null||a===void 0?void 0:a.email)||"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"rule.table.columns.text.status"}),children:(o==null||(s=o.userInfo)===null||s===void 0?void 0:s.status)||"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"cloudAccount.extend.title.createTime"}),children:o!=null&&(c=o.userInfo)!==null&&c!==void 0&&c.createDate?Z()(o==null||(g=o.userInfo)===null||g===void 0?void 0:g.createDate).format("YYYY-MM-DD HH:mm:ss"):"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"asset.module.text.last.login"}),children:o!=null&&(N=o.userInfo)!==null&&N!==void 0&&N.lastLoginDate?Z()(o==null||(L=o.userInfo)===null||L===void 0?void 0:L.lastLoginDate).format("YYYY-MM-DD HH:mm:ss"):"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(h.Z.Item,{label:T.formatMessage({id:"asset.module.text.mfa.status"}),children:(0,e.jsx)(p,{enable:o==null||(b=o.userInfo)===null||b===void 0?void 0:b.mfastatus})})})]})})})},C=i,y=t(32983),F=function(){return(0,e.jsx)(R.Z,{children:(0,e.jsx)(y.Z,{image:y.Z.PRESENTED_IMAGE_SIMPLE})})},M=F,V=t(81569),z=t(29297),X=function(m){var u=m.record;return(0,e.jsx)("div",{children:u.policyDocument&&(0,e.jsx)(z.q9,{editorKey:"POLICY_DOCUMENT_CONFIG_INSTANCE",value:JSON.stringify(JSON.parse(u.policyDocument),null,4)||"",readOnly:!0,editorStyle:{height:240}})})},w=X,q=t(21532),_=t(89094),ee=function(){var m=(0,n.useLocation)(),u=new URLSearchParams(m.search),a=u.get("id"),s=(0,n.useIntl)(),c=(0,n.useRequest)(function(O){return(0,j.queryIdentityDetailById)({id:O})},{manual:!0,formatResult:function(A){return A==null?void 0:A.content}}),g=c.run,N=c.data,L=c.loading;(0,S.useEffect)(function(){a&&g(Number(a))},[a]);var b=[{title:s.formatMessage({id:"asset.module.text.policy.name"}),dataIndex:"policyName",key:"policyName"},{title:s.formatMessage({id:"asset.module.text.policy.description"}),dataIndex:"description",key:"description"},{title:s.formatMessage({id:"asset.module.text.policy.type"}),dataIndex:"policyType",key:"policyType"},{title:s.formatMessage({id:"asset.module.text.source"}),dataIndex:"source",key:"source",render:function(A,l){return(l==null?void 0:l.source)||"-"}}];return(0,e.jsx)(R.Z,{loading:L,title:s.formatMessage({id:"asset.module.text.permission.policy"}),children:(0,e.jsx)(q.ZP,{theme:{components:{Table:{headerBg:"#FFF"}}},children:(0,e.jsx)(_.Z,{pagination:{size:"small"},dataSource:(N==null?void 0:N.policies)||[],columns:b,expandable:{expandedRowRender:function(A){return(0,e.jsx)(w,{record:A})},columnTitle:(0,e.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:V.Z}})})})},te=ee,ne=t(97857),H=t.n(ne),oe=t(5574),re=t.n(oe),ie=t(47221),ae=function(){var m=(0,n.useLocation)(),u=new URLSearchParams(m.search),a=u.get("id"),s=(0,S.useState)({}),c=re()(s,2),g=c[0],N=c[1],L=(0,n.useRequest)(function(l){return(0,j.queryRiskInfo)({id:l})},{manual:!0,formatResult:function(K){return K==null?void 0:K.content}}),b=L.run,O=L.data,A=L.loading;return(0,S.useEffect)(function(){a&&b(Number(a))},[a]),(0,e.jsx)(R.Z,{loading:A,title:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.risk.information"}),children:O==null?void 0:O.map(function(l,K){return(0,e.jsx)(ie.Z,{style:{marginBottom:12},expandIconPosition:"end",collapsible:"header",activeKey:g==null?void 0:g[K],onChange:function(T){N(H()(H()({},g),{},{index:T}))},items:[{key:"1",label:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(l==null?void 0:l.ruleName)||"-"}),(0,e.jsx)("div",{children:(l==null?void 0:l.ruleDesc)||"-"})]}),children:(0,e.jsx)(e.Fragment,{children:l.context&&(0,e.jsx)(z.q9,{editorKey:"IDENTITY_CONFIG_INSTANCE",value:JSON.stringify(JSON.parse(l.context),null,4)||"",readOnly:!0,editorStyle:{height:240}})})}]},K)})})},se=ae,le=t(87547),de=t(42952),ue=t(24019),ce=t(28058),$=t(96486),ve={false:"invalid",true:"valid"},fe={ascend:"ASC",descend:"DESC"},me=function(m,u){var a=(0,$.cloneDeep)(m);for(var s in a)if(a.hasOwnProperty(s)){var c=a[s];!(0,$.isEmpty)(c)&&Array.isArray(c)?c.forEach(function(g){g.status=ve[g.status],g.platform=u.platform,g.resourceType=u.resourceType}):c===void 0&&(a[s]=[])}return a},ge={invalid:!1,valid:!0},ye=function(m){var u=(0,$.cloneDeep)(m);for(var a in u)if(u.hasOwnProperty(a)){var s=u[a];!(0,$.isEmpty)(s)&&Array.isArray(s)&&s.forEach(function(c){c.status=ge[c.status]})}return u},xe={linkIcon:"https://mdn.alipayobjects.com/huamei_f8hv0x/afts/img/A*a8O4QrNtEvwAAAAAAAAAAAAADiiJAQ/original"},je={components:{Input:{colorBgContainerDisabled:"#FFF",colorTextDisabled:"rgba(0, 0, 0, 0.88)",algorithm:!0}}},pe=null,he=[{key:"ACCOUNT",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.account.info"}),icon:(0,e.jsx)(le.Z,{}),children:(0,e.jsx)(C,{})},{key:"PERMISSION",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.permission"}),icon:(0,e.jsx)(de.Z,{}),children:(0,e.jsx)(te,{})},{key:"LOG",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.activity.log"}),icon:(0,e.jsx)(ue.Z,{}),children:(0,e.jsx)(M,{})},{key:"RISK",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.risks"}),icon:(0,e.jsx)(ce.Z,{}),children:(0,e.jsx)(se,{})}]},85674:function(W,P,t){var v={"./simpleWorker":18352,"./simpleWorker.js":18352};function f(d){return Promise.resolve().then(function(){if(!t.o(v,d)){var n=new Error("Cannot find module '"+d+"'");throw n.code="MODULE_NOT_FOUND",n}var D=v[d];return t(D)})}f.keys=function(){return Object.keys(v)},f.id=85674,W.exports=f},10131:function(W,P,t){var v={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function f(d){if(!t.o(v,d))return Promise.resolve().then(function(){var x=new Error("Cannot find module '"+d+"'");throw x.code="MODULE_NOT_FOUND",x});var n=v[d],D=n[0];return Promise.all(n.slice(1).map(t.e)).then(function(){return t(D)})}f.keys=function(){return Object.keys(v)},f.id=10131,W.exports=f}}]);
