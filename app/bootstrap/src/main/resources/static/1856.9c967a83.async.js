"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1856],{31732:function(N,h,t){var y=t(97857),u=t.n(y),j=t(66309),k=t(62435),D=t(86074);h.Z=function(x){var p=x.text,b=x.style;return(0,D.jsx)(j.Z,{style:u()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},b),children:p})}},57207:function(N,h,t){t.d(h,{Z:function(){return de}});var y=t(5574),u=t.n(y),j=t(87426),k=t(39421),D=t(24163),x=t(71448),p=t(24482),b=t(50322),$=t(22145),S=t(96364),K=t(77603),G=t(72028),P=t(29448),H=t(87462),a=t(62435),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},Q=J,X=t(84089),Y=function(c,v){return a.createElement(X.Z,(0,H.Z)({},c,{ref:v,icon:Q}))},q=a.forwardRef(Y),_=q,ee=t(99611),se=t(45742),te=t(93410),g=t(45830),re=t(25593),m=t(68872),le=t(85265),o=t(86250),w=t(83062),R=t(83622),ie=t(42075),ne=t(66309),ae=t(21532),f=t(23323),L=t(47908),s=t(86074),d=re.Z.Text,oe=function(c){var v,I,Z,C,M,E,A=c.riskDrawerVisible,l=c.riskDrawerInfo,ue=c.setRiskDrawerVisible,me=c.locate,ve=(0,g.useModel)("rule"),xe=ve.platformList,ge=(0,g.useModel)("tenant"),O=ge.tenantListAll,r=(0,g.useIntl)(),fe=(0,a.useState)(!1),T=u()(fe,2),he=T[0],ye=T[1],je=(0,a.useState)(!1),B=u()(je,2),De=B[0],W=B[1],pe=(0,a.useState)(!1),F=u()(pe,2),be=F[0],U=F[1],Re=function(){ue(!1)},V=(0,g.useRequest)(function(i){return(0,G.queryRiskDetailById)({riskId:i})},{manual:!0,formatResult:function(n){return n.content||{}}}),e=V.data,Ie=V.run,Ze=V.loading,Ce=function(){Re()},Me=(0,a.useCallback)(function(){if(!(l!=null&&l.id)){m.ZP.error(r.formatMessage({id:"common.message.text.copy.failed"}));return}var i="".concat(window.location.origin,"/riskManagement/riskDetail?id=").concat(l.id);navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(i).then(function(){m.ZP.success(r.formatMessage({id:"common.message.text.copy.success"}))}).catch(function(){z(i)}):z(i)},[l==null?void 0:l.id,r]),z=(0,a.useCallback)(function(i){var n=document.createElement("textarea");n.value=i,n.style.top="0",n.style.left="0",n.style.position="fixed",n.style.opacity="0",n.style.pointerEvents="none",n.style.zIndex="-1",document.body.appendChild(n),n.focus(),n.select();try{var Ee=document.execCommand("copy");Ee?m.ZP.success(r.formatMessage({id:"common.message.text.copy.success"})):m.ZP.error(r.formatMessage({id:"common.message.text.copy.failed"}))}catch(Ae){console.error("Fallback copy failed:",Ae),m.ZP.error(r.formatMessage({id:"common.message.text.copy.failed"}))}finally{document.body.contains(n)&&document.body.removeChild(n)}},[r]);return(0,a.useEffect)(function(){A&&l!==null&&l!==void 0&&l.id&&Ie(l.id)},[A,l]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(le.Z,{title:(0,s.jsxs)(o.Z,{justify:"space-between",align:"center",children:[(0,s.jsx)("span",{children:r.formatMessage({id:"risk.module.text.detail.info"})}),(0,s.jsx)(w.Z,{title:r.formatMessage({id:"common.button.text.share"}),children:(0,s.jsx)(R.ZP,{type:"text",icon:(0,s.jsx)(_,{}),onClick:Me,style:{marginRight:-8},"aria-label":r.formatMessage({id:"common.button.text.share"})})})]}),width:"50%",open:A,onClose:Ce,loading:Ze,children:[(0,s.jsxs)(te.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,s.jsx)(o.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,s.jsxs)("span",{children:[(0,s.jsx)(d,{style:{marginRight:12},children:(0,s.jsx)(R.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(e==null||(v=e.ruleVO)===null||v===void 0?void 0:v.ruleName)||"-"})}),(0,s.jsxs)(ie.Z,{children:[(0,s.jsx)("span",{children:(0,P.Ff)(S.MW,e==null?void 0:e.status)}),(e==null?void 0:e.ignoreReasonType)&&(0,s.jsxs)("span",{children:[(0,s.jsxs)(d,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[r.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,s.jsx)(ne.Z,{color:"geekblue",children:((I=S.$G.find(function(i){return i.value===(e==null?void 0:e.ignoreReasonType)}))===null||I===void 0?void 0:I.label)||"-"})]}),(e==null?void 0:e.ignoreReason)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(d,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[r.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,s.jsx)(D.Z,{rows:1,text:e==null?void 0:e.ignoreReason,maxWidth:64})]}),(e==null?void 0:e.whitedId)&&(0,s.jsx)(R.ZP,{type:"link",size:"small",icon:(0,s.jsx)(ee.Z,{}),onClick:function(){return U(!0)},style:{padding:"0 4px",height:"auto",color:"#1890ff"}})]})]})}),(0,s.jsxs)(o.Z,{vertical:!0,gap:10,children:[(0,s.jsxs)(o.Z,{align:"center",children:[(0,s.jsx)("img",{src:k.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,s.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[r.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:e==null?void 0:e.gmtModified})]}),(0,s.jsxs)(d,{children:[(0,s.jsx)("img",{src:j.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,s.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[r.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:e==null?void 0:e.gmtCreate})]})]}),(0,s.jsxs)(o.Z,{align:"center",style:{margin:"10px 0 6px 0"},children:[(0,s.jsxs)("span",{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[r.formatMessage({id:"common.select.label.cloudAccount"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)",marginRight:16},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,s.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",marginRight:16},children:(e==null?void 0:e.alias)||"-"})]}),(0,s.jsxs)(o.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,s.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,P.fD)(e==null?void 0:e.platform,xe)}),(0,s.jsx)(d,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(e==null?void 0:e.resourceType)||"-"}),(0,s.jsxs)(o.Z,{align:"center",children:[(0,s.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(e==null?void 0:e.resourceName)+" / "+(e==null?void 0:e.resourceId)}),me==="risk"&&(0,s.jsx)(w.Z,{title:r.formatMessage({id:"asset.extend.text.detail"}),children:(0,s.jsx)("span",{className:L.Z.iconWrap,onClick:function(){return W(!0)},children:(0,s.jsx)(se.Z,{className:L.Z.resourceInstance})})})]}),(0,s.jsx)(d,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(O==null||(Z=O.find(function(i){return i.value===(e==null?void 0:e.tenantId)}))===null||Z===void 0?void 0:Z.label)||"-"})]})]}),(0,s.jsx)(ae.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,s.jsxs)(f.Z,{children:[(0,s.jsx)(f.Z.Item,{label:r.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(C=e.ruleVO)===null||C===void 0?void 0:C.advice)||"-"})}),(0,s.jsx)(f.Z.Item,{label:r.formatMessage({id:"risk.module.text.reference.link"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(M=e.ruleVO)===null||M===void 0?void 0:M.link)||"-"})}),(0,s.jsx)(f.Z.Item,{label:r.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(E=e.ruleVO)===null||E===void 0?void 0:E.ruleDesc)||"-"})})]})}),(0,s.jsx)(x.Z,{riskDrawerInfo:l}),(0,s.jsx)(b.Z,{riskDrawerInfo:l})]}),(0,s.jsx)(p.Z,{evaluateDrawerVisible:he,setEvaluateDrawerVisible:ye,riskDrawerInfo:l}),(0,s.jsx)($.Z,{resourceDrawerVisible:De,setResourceDrawerVisible:W,riskDrawerInfo:l}),(e==null?void 0:e.whitedId)&&(0,s.jsx)(K.Z,{editDrawerVisible:be,setEditDrawerVisible:U,whiteListDrawerInfo:{id:e.whitedId,isEditMode:!1}})]})},de=oe}}]);
