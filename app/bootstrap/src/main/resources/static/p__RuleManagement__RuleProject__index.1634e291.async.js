(self.webpackChunk=self.webpackChunk||[]).push([[6673],{52745:function(oe,$,t){"use strict";t.d($,{Z:function(){return g}});var T=t(87462),p=t(62435),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},P=Z,A=t(84089),i=function(I,J){return p.createElement(A.Z,(0,T.Z)({},I,{ref:J,icon:P}))},Q=p.forwardRef(i),g=Q},31732:function(oe,$,t){"use strict";var T=t(97857),p=t.n(T),Z=t(66309),P=t(62435),A=t(86074);$.Z=function(i){var Q=i.text,g=i.style;return(0,A.jsx)(Z.Z,{style:p()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},g),children:Q})}},24163:function(oe,$,t){"use strict";var T=t(97857),p=t.n(T),Z=t(25593),P=t(83062),A=t(62435),i=t(86074),Q=Z.Z.Paragraph;$.Z=function(g){var F=g.text,I=g.width,J=g.maxWidth,D=g.rows,U=D===void 0?2:D,re=g.placement,pe=re===void 0?"top":re,w=g.color,M=w===void 0?"rgba(0, 0, 0, 0.88)":w,X=g.link,je=X===void 0?!1:X,de=g.onClickCallBackFunc,Y=g.style,_=Y===void 0?{}:Y,ie=g.copyable,we=ie===void 0?!1:ie;return(0,i.jsx)("div",{style:{maxWidth:J,width:I},children:(0,i.jsx)(P.Z,{title:(0,i.jsx)("div",{children:F}),placement:pe,children:(0,i.jsx)(Q,{ellipsis:{rows:U},style:p()({marginBottom:0,color:M,cursor:je?"pointer":""},_),onClick:de,copyable:we,children:F})})})}},28235:function(oe,$,t){"use strict";var T=t(97857),p=t.n(T),Z=t(25593),P=t(83062),A=t(62435),i=t(86074),Q=Z.Z.Paragraph;$.Z=function(g){var F=g.text,I=g.width,J=g.maxWidth,D=g.rows,U=D===void 0?2:D,re=g.placement,pe=re===void 0?"top":re,w=g.color,M=w===void 0?"rgba(0, 0, 0, 0.88)":w,X=g.link,je=X===void 0?!1:X,de=g.onClickCallBackFunc,Y=g.style,_=Y===void 0?{}:Y,ie=g.copyable,we=ie===void 0?!1:ie,he=g.tooltipText;return(0,i.jsx)("div",{style:{maxWidth:J,width:I},children:(0,i.jsx)(P.Z,{title:he,placement:pe,children:(0,i.jsx)(Q,{ellipsis:{rows:U},style:p()({marginBottom:0,color:M,cursor:je?"pointer":""},_),onClick:de,copyable:we,children:F})})})}},64818:function(oe,$,t){"use strict";var T=t(15009),p=t.n(T),Z=t(99289),P=t.n(Z),A=t(5574),i=t.n(A),Q=t(62435),g=t(68872),F=t(66309),I=t(85265),J=t(57381),D=t(26412),U=t(25593),re=t(45830),pe=t(96655),w=t(29448),M=t(86074),X=function(de){var Y=de.visible,_=de.onClose,ie=de.ruleId,we=de.ruleCode,he=(0,re.useIntl)(),Ce=g.ZP.useMessage(),m=i()(Ce,2),pt=m[0],ht=m[1],nt=(0,Q.useState)(!1),se=i()(nt,2),r=se[0],c=se[1],k=(0,Q.useState)(null),y=i()(k,2),h=y[0],q=y[1];(0,Q.useEffect)(function(){Y&&ie&&V()},[Y,ie]);var V=function(){var ce=P()(p()().mark(function G(){var fe;return p()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(c(!0),O.prev=1,!ie){O.next=6;break}return O.next=5,(0,pe.queryRuleDetail)({id:ie});case 5:fe=O.sent;case 6:fe&&fe.content&&q(fe.content),O.next=12;break;case 9:O.prev=9,O.t0=O.catch(1),pt.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return O.prev=12,c(!1),O.finish(12);case 15:case"end":return O.stop()}},G,null,[[1,9,12,15]])}));return function(){return ce.apply(this,arguments)}}(),ye=function(){q(null),_()},me=function(G){switch(G.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},xe=function(G){if(!G)return null;var fe=G.split(",");return fe.map(function(Pe,O){return(0,M.jsx)(F.Z,{color:me(Pe.trim()),children:Pe.trim()},O)})},Re=function(G){return(0,w.c5)(G)};return(0,M.jsxs)(M.Fragment,{children:[ht,(0,M.jsx)(I.Z,{placement:"right",onClose:ye,open:Y,width:1e3,destroyOnClose:!0,children:(0,M.jsx)(J.Z,{spinning:r,children:h&&(0,M.jsxs)(D.Z,{column:1,bordered:!0,children:[(0,M.jsx)(D.Z.Item,{label:he.formatMessage({id:"home.module.inform.columns.ruleName"},{}),children:(0,M.jsx)(U.Z.Text,{copyable:!0,children:h.ruleName})}),(0,M.jsx)(D.Z.Item,{label:"Code",children:(0,M.jsx)(U.Z.Text,{copyable:!0,children:h.ruleCode})}),(0,M.jsx)(D.Z.Item,{label:he.formatMessage({id:"rule.module.text.repair.suggestions"},{}),children:(0,M.jsx)(U.Z.Text,{copyable:!0,children:h.advice})}),(0,M.jsx)(D.Z.Item,{label:he.formatMessage({id:"rule.module.text.reference.link"},{}),children:(0,M.jsx)(U.Z.Text,{copyable:!0,children:h.link})}),(0,M.jsx)(D.Z.Item,{label:he.formatMessage({id:"rule.module.text.risk.context.template"},{}),children:(0,M.jsx)(U.Z.Text,{copyable:!0,children:h.context})}),h.ruleRego&&(0,M.jsx)(D.Z.Item,{label:"Rego Policy",children:(0,M.jsx)(U.Z.Text,{copyable:{text:h.ruleRego},children:(0,M.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"2048px",overflow:"auto"},children:h.ruleRego})})}),h.gmtModified&&(0,M.jsx)(D.Z.Item,{label:he.formatMessage({id:"common.text.update.time"},{}),children:(0,M.jsx)(U.Z.Text,{copyable:!0,children:h.gmtModified})})]})})})]})};$.Z=X},14842:function(oe,$,t){"use strict";t.r($),t.d($,{default:function(){return xa}});var T=t(15009),p=t.n(T),Z=t(99289),P=t.n(Z),A=t(5574),i=t.n(A),Q=t(79930),g=t(96655),F=t(17910),I=t(29448),J=t(39380),D=t(93410),U=t(45830),re=t(3303),pe=t(68872),w=t(23323),M=t(71230),X=t(15746),je=t(84567),de=t(34041),Y=t(42075),_=t(83622),ie=t(92398),we=t(68795),he=t(33160),Ce=t(96486),m=t(62435),pt=t(13769),ht=t.n(pt),nt=t(9783),se=t.n(nt),r=t(97857),c=t.n(r),k=t(31732),y=t(24163),h=t(28235),q=t(64818),V=t(87462),ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},me=ye,xe=t(84089),Re=function(S,j){return m.createElement(xe.Z,(0,V.Z)({},S,{ref:j,icon:me}))},ce=m.forwardRef(Re),G=ce,fe=t(86548),Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},O=Pe,Ct=function(S,j){return m.createElement(xe.Z,(0,V.Z)({},S,{ref:j,icon:O}))},lt=m.forwardRef(Ct),Kt=lt,yt=t(52745),Dt=t(24969),ot=t(90498),kt=t(75302),ee=t(83062),At=t(55241),xt=t(86738),Ft=t(72269),Vt=function(){return{style:{cursor:"pointer"},onMouseEnter:function(j){j.currentTarget.style.backgroundColor="#f5f5f5",j.currentTarget.style.transform="scale(1.01)",j.currentTarget.style.transition="all 0.2s ease",j.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseLeave:function(j){j.currentTarget.style.backgroundColor="",j.currentTarget.style.transform="scale(1)",j.currentTarget.style.boxShadow=""}}},Rt=function(S){return function(j){return c()({onClick:function(){return S(j)}},Vt())}},a=t(86074),Gt=["pageSize","current"],Bt=kt.ZP.useBreakpoint,Ht=function(S){var j=S.form,ue=S.platformList,Ie=S.resourceTypeList,We=S.ruleGroupList,bt=S.ruleTypeList,Oe=S.allRuleList,ve=S.checkNewRules,Ze=S.newRulesCount,be=S.queryTrigger,ne=pe.ZP.useMessage(),it=i()(ne,2),z=it[0],Se=it[1],Te=Bt(),x=(0,m.useRef)(),Tt=(0,m.useRef)(),d=(0,U.useIntl)(),K=(0,m.useState)(),Mt=i()(K,2),ut=Mt[0],Lt=Mt[1],ct=(0,m.useState)({}),Ge=i()(ct,2),jt=Ge[0],Wt=Ge[1],Jt=(0,m.useState)(!1),Pt=i()(Jt,2),dt=Pt[0],He=Pt[1],Qe=(0,m.useState)(),Je=i()(Qe,2),mt=Je[0],ft=Je[1],ge=(0,m.useState)({}),De=i()(ge,2),Ne=De[0],vt=De[1],Nt=(0,m.useState)({}),Xe=i()(Nt,2),Ue=Xe[0],ke=Xe[1],Ye=(0,m.useState)({}),qe=i()(Ye,2),et=qe[0],Ke=qe[1],tt=(0,m.useState)([]),Fe=i()(tt,2),Ae=Fe[0],Ve=Fe[1],_t=(0,m.useState)(!1),Be=i()(_t,2),Et=Be[0],Me=Be[1],It=(0,m.useState)(!1),Le=i()(It,2),at=Le[0],$e=Le[1],Ot=(0,m.useState)(!1),rt=i()(Ot,2),te=rt[0],W=rt[1],ae=(0,m.useState)(!1),Zt=i()(ae,2),le=Zt[0],Ut=Zt[1];(0,m.useEffect)(function(){if(be!==void 0&&be>0){var f;(f=x.current)===null||f===void 0||f.reload()}},[be]);var Xt=function(u){return u.id===ut?"ant-table-row-selected":""},Yt=function(u){ft(u.id),He(!0)},qt=function(){He(!1),ft(void 0)},ea=function(){var f=P()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=z.loading(d.formatMessage({id:"common.message.text.delete.loading"})),s.next=3,(0,g.deleteRule)({id:e});case 3:l=s.sent,n(),(l.code===200||l.msg==="success")&&(z.success(d.formatMessage({id:"common.message.text.delete.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v));case 6:case"end":return s.stop()}},u)}));return function(e){return f.apply(this,arguments)}}(),ta=function(){var f=P()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return vt(c()(c()({},Ne),{},se()({},e,!0))),n=z.loading(d.formatMessage({id:"common.message.text.copy.loading"})),s.next=4,(0,g.copyRule)({id:e});case 4:l=s.sent,vt(c()(c()({},Ne),{},se()({},e,!1))),n(),(l.code===200||l.msg==="success")&&(z.success(d.formatMessage({id:"common.message.text.copy.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v));case 8:case"end":return s.stop()}},u)}));return function(e){return f.apply(this,arguments)}}(),aa=function(){var f=P()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=e.id,ke(c()(c()({},Ue),{},se()({},n,!0))),s.prev=2,s.next=5,(0,g.addTenantSelectRule)({ruleCode:e.ruleCode});case 5:l=s.sent,(l.code===200||l.msg==="success")&&(z.success(d.formatMessage({id:"common.message.text.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),z.error(d.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,ke(c()(c()({},Ue),{},se()({},n,!1))),s.finish(12);case 15:case"end":return s.stop()}},u,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),E=function(){var f=P()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=e.id,Ke(c()(c()({},et),{},se()({},n,!0))),s.prev=2,s.next=5,(0,g.removeTenantSelectRule)({ruleCode:e.ruleCode});case 5:l=s.sent,(l.code===200||l.msg==="success")&&(z.success(d.formatMessage({id:"common.message.text.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),z.error(d.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,Ke(c()(c()({},et),{},se()({},n,!1))),s.finish(12);case 15:case"end":return s.stop()}},u,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),L=function(){var f=P()(p()().mark(function u(){var e,n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Ut(!0),s.prev=1,e=Oe==null?void 0:Oe.filter(function(H){return Ae.includes(H.id)}),n=(e==null?void 0:e.map(function(H){return H.ruleCode}))||[],n.length!==0){s.next=7;break}return z.warning(d.formatMessage({id:"common.message.text.no.valid.data"})),s.abrupt("return");case 7:return s.next=9,(0,g.batchAddTenantSelectRule)({ruleCodeList:n});case 9:l=s.sent,(l.code===200||l.msg==="success")&&(z.success(d.formatMessage({id:"common.message.text.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v),Ve([])),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(1),z.error(d.formatMessage({id:"common.message.text.failed"}));case 16:return s.prev=16,Ut(!1),s.finish(16);case 19:case"end":return s.stop()}},u,null,[[1,13,16,19]])}));return function(){return f.apply(this,arguments)}}(),o=function(u){W(!0),(0,g.queryExportRuleList)(u?{idList:u}:void 0,{responseType:"blob"}).then(function(e){(0,I.a5)(e,"CloudRec ".concat(d.formatMessage({id:"rule.module.text.rule.data"}))),z.success(d.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return W(!1)})},R=function(){var f=P()(p()().mark(function u(e,n){var l,v,C,b;return p()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return l={id:e,status:n},H.next=3,(0,g.changeRuleStatus)(l);case 3:v=H.sent,(v.code===200||v.msg==="success")&&(z.success(d.formatMessage({id:"common.message.text.edit.success"})),(C=x.current)===null||C===void 0||(b=C.reloadAndRest)===null||b===void 0||b.call(C));case 5:case"end":return H.stop()}},u)}));return function(e,n){return f.apply(this,arguments)}}(),B=[{title:d.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){var n,l,v=(e==null?void 0:e.selectedTenantNameList)&&e.selectedTenantNameList.length>0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)(h.Z,{placement:"topLeft",maxWidth:Te!=null&&Te.xxl?600:400,rows:1,text:(e==null?void 0:e.ruleName)||"-",style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),v&&(0,a.jsx)(ee.Z,{title:(0,a.jsx)("div",{children:(n=e.selectedTenantNameList)===null||n===void 0?void 0:n.map(function(C,b){return(0,a.jsxs)("div",{style:{fontSize:12},children:["\u2022 ",C]},b)})}),placement:"topRight",children:(0,a.jsx)(G,{style:{color:"#1890ff",fontSize:14,cursor:"pointer"}})})]}),(0,a.jsx)(y.Z,{placement:"topLeft",maxWidth:Te!=null&&Te.xxl?600:400,rows:1,text:(e==null||(l=e.ruleTypeNameList)===null||l===void 0?void 0:l.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){return(0,a.jsx)(k.Z,{text:(e==null?void 0:e.resourceTypeStr)||"-"})}},{title:d.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,I.W_)(F.I9),align:"center",hideInSearch:!0,render:function(u,e){return(0,I.Dd)(F.I9,e==null?void 0:e.riskLevel)}},{title:d.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){return(0,a.jsxs)("div",{children:[(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:d.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,I.W_)(ue),align:"center",hideInSearch:!0,render:function(u,e){return(0,I.c5)(e.platform,ue)}},{title:d.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:d.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(u,e){return(0,a.jsxs)(Y.Z,{size:"small",children:[(0,a.jsx)(_.ZP,{size:"small",onClick:function(l){l.stopPropagation(),Lt(e.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.id),children:(0,a.jsx)(ee.Z,{title:d.formatMessage({id:"common.button.text.edit"}),children:(0,a.jsx)(fe.Z,{})})}),(0,a.jsx)(At.Z,{content:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(xt.Z,{title:d.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(l){l==null||l.stopPropagation(),ea(e.id)},okText:d.formatMessage({id:"common.button.text.ok"}),cancelText:d.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(_.ZP,{block:!0,type:"link",danger:!0,size:"small",onClick:function(l){return l.stopPropagation()},children:d.formatMessage({id:"common.button.text.delete"})})}),(0,a.jsx)(_.ZP,{block:!0,loading:Ne[Number(e.id)],onClick:function(l){l.stopPropagation(),ta(e.id)},type:"link",target:"_blank",size:"small",children:d.formatMessage({id:"common.button.text.copy"})})]}),children:(0,a.jsx)(_.ZP,{type:"link",icon:(0,a.jsx)(Kt,{}),onClick:function(l){return l.stopPropagation()}})}),e.tenantSelected?(0,a.jsx)(xt.Z,{title:d.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(l){l==null||l.stopPropagation(),E(e)},onCancel:function(l){return l==null?void 0:l.stopPropagation()},okText:d.formatMessage({id:"common.button.text.ok"}),cancelText:d.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(_.ZP,{type:"default",size:"small",loading:et[Number(e.id)],onClick:function(l){return l.stopPropagation()},icon:(0,a.jsx)(yt.Z,{}),danger:!0})}):(0,a.jsx)(_.ZP,{type:"primary",size:"small",loading:Ue[Number(e.id)],onClick:function(l){l.stopPropagation(),aa(e)},icon:(0,a.jsx)(Dt.Z,{})}),(0,a.jsx)(ee.Z,{title:d.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,a.jsx)(Ft.Z,{checked:(e==null?void 0:e.status)==="valid",onClick:function(l,v){v==null||v.stopPropagation(),R(e.id,(e==null?void 0:e.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[Se,(0,a.jsx)(ot.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:Ae,onChange:function(u){return Ve(u)},preserveSelectedRowKeys:!0},actionRef:x,formRef:Tt,rowClassName:Xt,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(_.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:d.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,a.jsx)(At.Z,{open:Et,onOpenChange:function(e){return Me(e)},title:d.formatMessage({id:"rule.module.text.sync.confirm"}),content:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(_.ZP,{danger:!0,type:"default",loading:at,onClick:P()(p()().mark(function u(){var e,n,l,v;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return $e(!0),e=z.loading(d.formatMessage({id:"rule.module.text.sync.loading"})),b.prev=2,b.next=5,(0,g.loadRuleFromGithub)({coverage:!0});case 5:n=b.sent,(n.code===200||n.msg==="success")&&(z.success(d.formatMessage({id:"rule.module.text.sync.success"})),(l=x.current)===null||l===void 0||(v=l.reloadAndRest)===null||v===void 0||v.call(l),ve());case 7:return b.prev=7,e(),$e(!1),Me(!1),b.finish(7);case 12:case"end":return b.stop()}},u,null,[[2,,7,12]])})),children:d.formatMessage({id:"rule.module.text.sync.overwrite"})}),(0,a.jsx)(_.ZP,{type:"default",loading:at,onClick:P()(p()().mark(function u(){var e,n,l,v;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return $e(!0),e=z.loading(d.formatMessage({id:"rule.module.text.sync.loading"})),b.prev=2,b.next=5,(0,g.loadRuleFromGithub)({coverage:!1});case 5:n=b.sent,(n.code===200||n.msg==="success")&&(z.success(d.formatMessage({id:"rule.module.text.sync.success"})),(l=x.current)===null||l===void 0||(v=l.reloadAndRest)===null||v===void 0||v.call(l),ve());case 7:return b.prev=7,e(),$e(!1),Me(!1),b.finish(7);case 12:case"end":return b.stop()}},u,null,[[2,,7,12]])})),children:d.formatMessage({id:"rule.module.text.sync.no.overwrite"})}),(0,a.jsx)(_.ZP,{onClick:function(){Me(!1)},children:d.formatMessage({id:"common.button.text.cancel"})})]}),trigger:"click",children:(0,a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,a.jsx)(_.ZP,{type:"default",children:d.formatMessage({id:"rule.module.text.sync.button"})}),Ze>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ff4d4f",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},children:Ze>99?"99+":Ze})]})},"sync"),(0,a.jsx)(_.ZP,{type:"default",loading:le,disabled:Ae.length===0,onClick:L,children:d.formatMessage({id:"rule.module.text.batch.add.to.favorites"})},"BATCH_ADD_TO_FAVORITES"),(0,a.jsx)(_.ZP,{loading:te,type:"default",disabled:Ae.length===0,onClick:function(){return o(Ae)},children:d.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var f=P()(p()().mark(function u(e,n){var l,v,C,b,s,H,N,ra,st,la;return p()().wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return l=e.pageSize,v=e.current,C=ht()(e,Gt),b=j.getFieldsValue(),s=(0,I.Hm)(n),H=c()(c()(c()({},C),b),{},{page:v,size:l}),(0,Ce.isEmpty)(s)||(H.sortParam=s==null?void 0:s.key,H.sortType=s==null||(N=s.value)===null||N===void 0||(N=N.slice(0,-3))===null||N===void 0?void 0:N.toUpperCase()),gt.next=7,(0,g.queryRuleList)(H);case 7:return ra=gt.sent,st=ra.content,la=ra.code,gt.abrupt("return",{data:(st==null?void 0:st.data)||[],total:(st==null?void 0:st.total)||0,success:la===200||!1});case 11:case"end":return gt.stop()}},u)}));return function(u,e){return f.apply(this,arguments)}}(),columns:B,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:Rt(Yt)}),(0,a.jsx)(q.Z,{visible:dt,onClose:qt,ruleId:mt})]})},$t=Ht,ze=t(53846),Qt=t(90598),_e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},wt=_e,St=function(S,j){return m.createElement(xe.Z,(0,V.Z)({},S,{ref:j,icon:wt}))},oa=m.forwardRef(St),ia=oa,ua={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},ca=ua,da=function(S,j){return m.createElement(xe.Z,(0,V.Z)({},S,{ref:j,icon:ca}))},ma=m.forwardRef(da),fa=ma,zt=t(78045),va=["pageSize","current"],ga=kt.ZP.useBreakpoint,pa=function(S){var j=S.form,ue=S.platformList,Ie=S.resourceTypeList,We=S.ruleGroupList,bt=S.ruleTypeList,Oe=S.allRuleList,ve=S.queryTrigger,Ze=pe.ZP.useMessage(),be=i()(Ze,2),ne=be[0],it=be[1],z=ga(),Se=(0,m.useRef)(),Te=(0,m.useRef)(),x=(0,U.useIntl)(),Tt=(0,m.useState)(),d=i()(Tt,2),K=d[0],Mt=d[1],ut=(0,m.useState)({}),Lt=i()(ut,2),ct=Lt[0],Ge=Lt[1],jt=(0,m.useState)({}),Wt=i()(jt,2),Jt=Wt[0],Pt=Wt[1],dt=(0,m.useState)({}),He=i()(dt,2),Qe=He[0],Je=He[1],mt=(0,m.useState)([]),ft=i()(mt,2),ge=ft[0],De=ft[1],Ne=(0,m.useState)(!1),vt=i()(Ne,2),Nt=vt[0],Xe=vt[1],Ue=(0,m.useState)(!1),ke=i()(Ue,2),Ye=ke[0],qe=ke[1],et=(0,m.useState)(!1),Ke=i()(et,2),tt=Ke[0],Fe=Ke[1],Ae=(0,m.useState)(),Ve=i()(Ae,2),_t=Ve[0],Be=Ve[1],Et=(0,m.useState)(!0),Me=i()(Et,2),It=Me[0],Le=Me[1],at=(0,m.useState)(!1),$e=i()(at,2),Ot=$e[0],rt=$e[1],te=(0,m.useState)("all"),W=i()(te,2),ae=W[0],Zt=W[1],le=function(L){return L.id===K?"ant-table-row-selected":""},Ut=function(L){Be(L.id),Fe(!0)};(0,m.useEffect)(function(){if(ve!==void 0&&ve>0){var E;(E=Se.current)===null||E===void 0||E.reload()}},[ve]);var Xt=function(){var E=P()(p()().mark(function L(o){var R,B,f,u;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Ge(c()(c()({},ct),{},se()({},o,!0))),R=ne.loading(x.formatMessage({id:"common.message.text.execute.loading"})),n.next=4,(0,g.scanByRule)({id:o});case 4:B=n.sent,Ge(c()(c()({},ct),{},se()({},o,!1))),R(),(B.code===200||B.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.execute.success"})),(f=Se.current)===null||f===void 0||(u=f.reloadAndRest)===null||u===void 0||u.call(f));case 8:case"end":return n.stop()}},L)}));return function(o){return E.apply(this,arguments)}}(),Yt=function(){var E=P()(p()().mark(function L(o){var R,B,f,u;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return R=o.id,Je(c()(c()({},Qe),{},se()({},R,!0))),n.prev=2,n.next=5,(0,g.removeTenantSelectRule)({ruleCode:o.ruleCode});case 5:B=n.sent,(B.code===200||B.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.success"})),(f=Se.current)===null||f===void 0||(u=f.reloadAndRest)===null||u===void 0||u.call(f)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),ne.error(x.formatMessage({id:"common.message.text.fail"}));case 12:return n.prev=12,Je(c()(c()({},Qe),{},se()({},R,!1))),n.finish(12);case 15:case"end":return n.stop()}},L,null,[[2,9,12,15]])}));return function(o){return E.apply(this,arguments)}}(),qt=function(){var E=P()(p()().mark(function L(){var o,R,B,f;return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ge.length!==0){e.next=2;break}return e.abrupt("return");case 2:return Xe(!0),e.prev=3,o=ge.map(function(n){return Number(n)}),e.next=7,(0,g.scanRuleList)({idList:o});case 7:R=e.sent,(R.code===200||R.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.success"})),De([]),(B=Se.current)===null||B===void 0||(f=B.reloadAndRest)===null||f===void 0||f.call(B)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),ne.error(x.formatMessage({id:"common.message.text.fail"}));case 14:return e.prev=14,Xe(!1),e.finish(14);case 17:case"end":return e.stop()}},L,null,[[3,11,14,17]])}));return function(){return E.apply(this,arguments)}}(),ea=function(){var E=P()(p()().mark(function L(){var o,R,B,f,u,e,n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(ge.length!==0){s.next=2;break}return s.abrupt("return");case 2:return qe(!0),s.prev=3,R=j.getFieldsValue(),B={page:1,size:1e3,platformList:R.platformList,riskLevelList:R.riskLevelList,ruleCodeList:R.ruleCodeList,resourceTypeList:R.resourceTypeList,ruleGroupIdList:R.ruleGroupIdList,ruleTypeIdList:R.ruleTypeIdList},s.next=8,(0,g.queryEffectRuleList)(B);case 8:return f=s.sent,u=(f==null||(o=f.content)===null||o===void 0?void 0:o.data)||[],e=u.filter(function(H){return ge.includes(H.id)}),n=e.map(function(H){return H.ruleCode}),s.next=14,(0,g.batchDeleteTenantSelectRule)({ruleCodeList:n});case 14:l=s.sent,(l.code===200||l.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.success"})),De([]),(v=Se.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=21;break;case 18:s.prev=18,s.t0=s.catch(3),ne.error(x.formatMessage({id:"common.message.text.fail"}));case 21:return s.prev=21,qe(!1),s.finish(21);case 24:case"end":return s.stop()}},L,null,[[3,18,21,24]])}));return function(){return E.apply(this,arguments)}}(),ta=function(){var E=P()(p()().mark(function L(o,R){var B,f,u,e,n,l,v,C,b,s;return p()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return B=o.pageSize,f=o.current,u=ht()(o,va),N.prev=1,e=j.getFieldsValue(),n=c()({page:f||1,size:B||10,platformList:e.platformList,riskLevelList:e.riskLevelList,ruleCodeList:e.ruleCodeList,resourceTypeList:e.resourceTypeList,ruleGroupIdList:e.ruleGroupIdList,ruleTypeIdList:e.ruleTypeIdList,effectRuleType:ae},u),R&&Object.keys(R).length>0&&(l=Object.keys(R)[0],v=R[l],n.sortParam=l,n.sortType=v==="ascend"?"ASC":"DESC"),N.next=7,(0,g.queryEffectRuleList)(n);case 7:if(C=N.sent,!(C!=null&&C.content)){N.next=16;break}return b=C.content.data||[],s=C.content.total||0,Le(s>0),rt(!0),N.abrupt("return",{data:b,total:s,success:!0});case 16:return Le(!1),rt(!0),N.abrupt("return",{data:[],total:0,success:!1});case 19:N.next=26;break;case 21:return N.prev=21,N.t0=N.catch(1),Le(!1),rt(!0),N.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return N.stop()}},L,null,[[1,21]])}));return function(o,R){return E.apply(this,arguments)}}(),aa=[{title:x.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(L,o){var R;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontWeight:500,color:"rgb(58, 58, 58)",display:"flex",alignItems:"center",gap:"8px"},children:[(0,a.jsx)("span",{children:(o==null?void 0:o.ruleName)||"-"}),(o==null?void 0:o.defaultRuleSelected)&&(0,a.jsx)(ee.Z,{title:"default",children:(0,a.jsx)(Qt.Z,{style:{color:"#faad14",fontSize:"14px"}})})]}),(0,a.jsx)("div",{style:{color:"rgb(166, 167, 167)",fontSize:13},children:(o==null||(R=o.ruleTypeNameList)===null||R===void 0?void 0:R.toString())||"-"})]})}},{title:x.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(L,o){return(0,a.jsx)(k.Z,{text:(o==null?void 0:o.resourceTypeStr)||"-"})}},{title:x.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,I.W_)(F.I9),align:"center",hideInSearch:!0,render:function(L,o){return(0,I.Dd)(F.I9,o==null?void 0:o.riskLevel)}},{title:x.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,I.W_)(ue),align:"center",hideInSearch:!0,render:function(L,o){return(0,I.c5)(o.platform,ue)}},{title:x.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(L,o){return(0,a.jsx)(_.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(o==null?void 0:o.platform,"&ruleCode=").concat(o==null?void 0:o.ruleCode),children:o==null?void 0:o.riskCount})}},{title:x.formatMessage({id:"cloudAccount.extend.title.lastScanTime"}),dataIndex:"lastScanTime",valueType:"text",hideInSearch:!0,align:"center",width:150,sorter:!0,render:function(L,o){return o!=null&&o.lastScanTime?(0,a.jsx)(ee.Z,{title:o.lastScanTime,children:(0,a.jsx)("span",{children:o.lastScanTime})}):"-"}},{title:x.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",width:180,render:function(L,o){var R=o==null?void 0:o.isRunning,B=R===0,f=function(){return R===1?(0,a.jsx)(ia,{}):(0,a.jsx)(fa,{})};return(0,a.jsxs)(Y.Z,{size:"small",children:[(0,a.jsx)(_.ZP,{block:!0,loading:ct[Number(o.id)],disabled:!B,onClick:function(e){e.stopPropagation(),Xt(o.id)},type:"default",target:"_blank",size:"small",icon:f(),style:{color:R===1?"#52c41a":void 0,borderColor:R===1?"#52c41a":void 0},children:x.formatMessage({id:R===1?"common.button.text.running":"common.button.text.test"})}),ae==="selected"&&(0,a.jsx)(xt.Z,{title:x.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(e){e==null||e.stopPropagation(),Yt(o)},onCancel:function(e){return e==null?void 0:e.stopPropagation()},okText:x.formatMessage({id:"common.button.text.ok"}),cancelText:x.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(_.ZP,{danger:!0,size:"small",loading:Qe[Number(o.id)],disabled:R===1,icon:(0,a.jsx)(yt.Z,{}),onClick:function(e){return e.stopPropagation()}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[it,(0,a.jsx)(ot.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:ge,onChange:function(L){return De(L)},preserveSelectedRowKeys:!0},headerTitle:(0,a.jsx)("div",{className:ze.Z.customTitle,children:(0,a.jsx)(Y.Z,{children:(0,a.jsxs)(zt.ZP.Group,{value:ae,onChange:function(L){var o;Zt(L.target.value),De([]),(o=Se.current)===null||o===void 0||o.reload()},size:"middle",buttonStyle:"solid",children:[(0,a.jsx)(zt.ZP.Button,{value:"all",children:x.formatMessage({id:"common.module.text.all"})}),(0,a.jsx)(zt.ZP.Button,{value:"selected",children:x.formatMessage({id:"common.module.text.selected"})}),(0,a.jsx)(zt.ZP.Button,{value:"default",children:x.formatMessage({id:"common.module.text.default"})})]})})}),actionRef:Se,formRef:Te,rowClassName:le,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(_.ZP,{type:"primary",loading:Nt,disabled:ge.length===0,onClick:qt,children:x.formatMessage({id:"rule.module.text.batch.test"})},"BATCH_DETECT"),ae==="selected"&&(0,a.jsx)(_.ZP,{danger:!0,loading:Ye,disabled:ge.length===0,onClick:ea,children:x.formatMessage({id:"rule.module.text.batch.remove"})},"BATCH_REMOVE")].filter(Boolean)},request:ta,columns:aa,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:Rt(Ut)}),(0,a.jsx)(q.Z,{visible:tt,onClose:function(){return Fe(!1)},ruleId:_t})]})},ha=pa,sa=t(61194),na=re.Z.SHOW_CHILD,Ca=function(S,j){var ue,Ie,We=S.toLowerCase(),bt=((ue=j.label)===null||ue===void 0?void 0:ue.toLowerCase())||"",Oe=((Ie=j.value)===null||Ie===void 0?void 0:Ie.toLowerCase())||"";return bt.includes(We)||Oe.includes(We)},ya=function(){var S=(0,U.useModel)("rule"),j=S.platformList,ue=S.ruleTypeList,Ie=S.allRuleList,We=S.ruleGroupList,bt=(0,U.useLocation)(),Oe=bt.search,ve=new URLSearchParams(Oe),Ze=ve.get("groupId"),be=ve.get("ruleCode"),ne=ve.get("platform"),it=pe.ZP.useMessage(),z=i()(it,2),Se=z[0],Te=z[1],x=w.Z.useForm(),Tt=i()(x,1),d=Tt[0],K=(0,U.useIntl)(),Mt=(0,m.useState)(!1),ut=i()(Mt,2),Lt=ut[0],ct=ut[1],Ge=(0,m.useState)(!1),jt=i()(Ge,2),Wt=jt[0],Jt=jt[1],Pt=(0,m.useState)(0),dt=i()(Pt,2),He=dt[0],Qe=dt[1],Je=(0,m.useState)(!1),mt=i()(Je,2),ft=mt[0],ge=mt[1],De=(0,m.useState)([]),Ne=i()(De,2),vt=Ne[0],Nt=Ne[1],Xe=(0,m.useState)([]),Ue=i()(Xe,2),ke=Ue[0],Ye=Ue[1],qe=ve.get("tab"),et=(0,m.useState)(qe||"selected"),Ke=i()(et,2),tt=Ke[0],Fe=Ke[1];(0,m.useEffect)(function(){var te=ve.get("tab");te&&te!==tt&&Fe(te)},[Oe,tt]);var Ae=(0,m.useState)(!1),Ve=i()(Ae,2),_t=Ve[0],Be=Ve[1],Et=(0,m.useState)(0),Me=i()(Et,2),It=Me[0],Le=Me[1],at=function(){var te=P()(p()().mark(function W(){var ae;return p()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.prev=0,le.next=3,(0,g.checkExistNewRule)();case 3:ae=le.sent,ae.code===200&&typeof ae.content=="number"&&Qe(ae.content),le.next=10;break;case 7:le.prev=7,le.t0=le.catch(0),console.error("Failed to check new rules:",le.t0);case 10:case"end":return le.stop()}},W,null,[[0,7]])}));return function(){return te.apply(this,arguments)}}(),$e=(0,U.useRequest)(function(te){return(0,Q.queryGroupTypeList)({platformList:te})},{manual:!0,formatResult:function(W){var ae=W.content;Ye(ae||[])}}),Ot=$e.run,rt=function(W){ge(!0),(0,g.queryExportRuleList)(W?{idList:W}:void 0,{responseType:"blob"}).then(function(ae){(0,I.a5)(ae,"CloudRec ".concat(K.formatMessage({id:"rule.module.text.rule.data"}))),Se.success(K.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return ge(!1)})};return(0,m.useEffect)(function(){(0,Ce.isEmpty)(Ze)||d.setFieldValue("ruleGroupIdList",[Number(Ze)]),(0,Ce.isEmpty)(be)||d.setFieldValue("ruleCodeList",[be]),(0,Ce.isEmpty)(ne)||(d.setFieldValue("platformList",[ne]),Ot([ne])),at()},[Ze,be,ne]),(0,a.jsxs)(J._z,{ghost:!0,title:!1,className:sa.Z.rulePageContainer,breadcrumbRender:!1,children:[Te,(0,a.jsx)(D.Z,{bodyStyle:{paddingBottom:0},className:sa.Z.customFilterCard,children:(0,a.jsx)(w.Z,{form:d,children:(0,a.jsxs)(M.Z,{gutter:[24,10],style:{marginBottom:20},children:[(0,a.jsx)(X.Z,{span:24,children:(0,a.jsx)(w.Z.Item,{name:"platformList",label:K.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,a.jsx)(je.Z.Group,{options:(0,I.T$)(j),onChange:function(W){d.setFieldValue("resourceTypeList",null),Ye([]),Ot(W)}})})}),(0,a.jsx)(X.Z,{span:24,children:(0,a.jsx)(w.Z.Item,{name:"riskLevelList",label:K.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,a.jsx)(je.Z.Group,{options:(0,I.at)(F.I9)})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(w.Z.Item,{name:"resourceTypeList",label:K.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(re.Z,{options:ke,multiple:!0,placeholder:K.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:na,allowClear:!0,showSearch:!0})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(w.Z.Item,{name:"ruleTypeIdList",label:K.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(re.Z,{placeholder:K.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:na,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:ue||[]})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(w.Z.Item,{name:"ruleGroupIdList",label:K.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(de.Z,{placeholder:K.formatMessage({id:"common.select.text.placeholder"}),options:We,allowClear:!0,mode:"multiple"})})}),(0,a.jsx)(X.Z,{span:18,children:(0,a.jsx)(w.Z.Item,{name:"ruleCodeList",label:K.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,a.jsx)(de.Z,{filterOption:Ca,placeholder:K.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:Ie,mode:"multiple"})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(w.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(_.ZP,{type:"primary",icon:(0,a.jsx)(we.Z,{}),loading:_t,onClick:function(){Be(!0),Le(function(W){return W+1}),setTimeout(function(){Be(!1)},500)},children:K.formatMessage({id:"common.button.text.query"})}),(0,a.jsx)(_.ZP,{icon:(0,a.jsx)(he.Z,{}),onClick:function(){d.resetFields(),Ye([]),Be(!0),Le(function(W){return W+1}),setTimeout(function(){Be(!1)},500)},children:K.formatMessage({id:"common.button.text.reset"})})]})})})]})})}),(0,a.jsx)(D.Z,{style:{marginTop:16},children:(0,a.jsx)(ie.Z,{activeKey:tt,onChange:function(W){Fe(W),Le(function(ae){return ae+1})},items:[{key:"selected",label:K.formatMessage({id:"rule.module.text.selected.rules"}),children:(0,a.jsx)(ha,{form:d,platformList:j,resourceTypeList:ke,ruleGroupList:We,ruleTypeList:ue,allRuleList:Ie,queryTrigger:It})},{key:"market",label:K.formatMessage({id:"rule.module.text.market.rules"}),children:(0,a.jsx)($t,{form:d,platformList:j,resourceTypeList:ke,ruleGroupList:We,ruleTypeList:ue,allRuleList:Ie,checkNewRules:at,newRulesCount:He,queryTrigger:It})}]})})]})},xa=ya},53846:function(oe,$){"use strict";$.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(oe,$){"use strict";$.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(oe,$,t){"use strict";var T=t(25378);function p(){return(0,T.Z)()}$.ZP={useBreakpoint:p}},66309:function(oe,$,t){"use strict";t.d($,{Z:function(){return se}});var T=t(62435),p=t(93967),Z=t.n(p),P=t(98423),A=t(98787),i=t(69760),Q=t(96159),g=t(45353),F=t(53124),I=t(861),J=t(15063),D=t(14747),U=t(83262),re=t(83559);const pe=r=>{const{paddingXXS:c,lineWidth:k,tagPaddingHorizontal:y,componentCls:h,calc:q}=r,V=q(y).sub(k).equal(),ye=q(c).sub(k).equal();return{[h]:Object.assign(Object.assign({},(0,D.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:V,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,I.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${h}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${h}-close-icon`]:{marginInlineStart:ye,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${h}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${h}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:V}}),[`${h}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},w=r=>{const{lineWidth:c,fontSizeIcon:k,calc:y}=r,h=r.fontSizeSM;return(0,U.mergeToken)(r,{tagFontSize:h,tagLineHeight:(0,I.unit)(y(r.lineHeightSM).mul(h).equal()),tagIconSize:y(k).sub(y(c).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},M=r=>({defaultBg:new J.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var X=(0,re.I$)("Tag",r=>{const c=w(r);return pe(c)},M),je=function(r,c){var k={};for(var y in r)Object.prototype.hasOwnProperty.call(r,y)&&c.indexOf(y)<0&&(k[y]=r[y]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,y=Object.getOwnPropertySymbols(r);h<y.length;h++)c.indexOf(y[h])<0&&Object.prototype.propertyIsEnumerable.call(r,y[h])&&(k[y[h]]=r[y[h]]);return k},Y=T.forwardRef((r,c)=>{const{prefixCls:k,style:y,className:h,checked:q,onChange:V,onClick:ye}=r,me=je(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:xe,tag:Re}=T.useContext(F.E_),ce=lt=>{V==null||V(!q),ye==null||ye(lt)},G=xe("tag",k),[fe,Pe,O]=X(G),Ct=Z()(G,`${G}-checkable`,{[`${G}-checkable-checked`]:q},Re==null?void 0:Re.className,h,Pe,O);return fe(T.createElement("span",Object.assign({},me,{ref:c,style:Object.assign(Object.assign({},y),Re==null?void 0:Re.style),className:Ct,onClick:ce})))}),_=t(98719);const ie=r=>(0,_.Z)(r,(c,{textColor:k,lightBorderColor:y,lightColor:h,darkColor:q})=>({[`${r.componentCls}${r.componentCls}-${c}`]:{color:k,background:h,borderColor:y,"&-inverse":{color:r.colorTextLightSolid,background:q,borderColor:q},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var we=(0,re.bk)(["Tag","preset"],r=>{const c=w(r);return ie(c)},M);function he(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const Ce=(r,c,k)=>{const y=he(k);return{[`${r.componentCls}${r.componentCls}-${c}`]:{color:r[`color${k}`],background:r[`color${y}Bg`],borderColor:r[`color${y}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var m=(0,re.bk)(["Tag","status"],r=>{const c=w(r);return[Ce(c,"success","Success"),Ce(c,"processing","Info"),Ce(c,"error","Error"),Ce(c,"warning","Warning")]},M),pt=function(r,c){var k={};for(var y in r)Object.prototype.hasOwnProperty.call(r,y)&&c.indexOf(y)<0&&(k[y]=r[y]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,y=Object.getOwnPropertySymbols(r);h<y.length;h++)c.indexOf(y[h])<0&&Object.prototype.propertyIsEnumerable.call(r,y[h])&&(k[y[h]]=r[y[h]]);return k};const nt=T.forwardRef((r,c)=>{const{prefixCls:k,className:y,rootClassName:h,style:q,children:V,icon:ye,color:me,onClose:xe,bordered:Re=!0,visible:ce}=r,G=pt(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:fe,direction:Pe,tag:O}=T.useContext(F.E_),[Ct,lt]=T.useState(!0),Kt=(0,P.Z)(G,["closeIcon","closable"]);T.useEffect(()=>{ce!==void 0&&lt(ce)},[ce]);const yt=(0,A.o2)(me),Dt=(0,A.yT)(me),ot=yt||Dt,kt=Object.assign(Object.assign({backgroundColor:me&&!ot?me:void 0},O==null?void 0:O.style),q),ee=fe("tag",k),[At,xt,Ft]=X(ee),Vt=Z()(ee,O==null?void 0:O.className,{[`${ee}-${me}`]:ot,[`${ee}-has-color`]:me&&!ot,[`${ee}-hidden`]:!Ct,[`${ee}-rtl`]:Pe==="rtl",[`${ee}-borderless`]:!Re},y,h,xt,Ft),Rt=ze=>{ze.stopPropagation(),xe==null||xe(ze),!ze.defaultPrevented&&lt(!1)},[,a]=(0,i.Z)((0,i.w)(r),(0,i.w)(O),{closable:!1,closeIconRender:ze=>{const Qt=T.createElement("span",{className:`${ee}-close-icon`,onClick:Rt},ze);return(0,Q.wm)(ze,Qt,_e=>({onClick:wt=>{var St;(St=_e==null?void 0:_e.onClick)===null||St===void 0||St.call(_e,wt),Rt(wt)},className:Z()(_e==null?void 0:_e.className,`${ee}-close-icon`)}))}}),Gt=typeof G.onClick=="function"||V&&V.type==="a",Bt=ye||null,Ht=Bt?T.createElement(T.Fragment,null,Bt,V&&T.createElement("span",null,V)):V,$t=T.createElement("span",Object.assign({},Kt,{ref:c,className:Vt,style:kt}),Ht,a,yt&&T.createElement(we,{key:"preset",prefixCls:ee}),Dt&&T.createElement(m,{key:"status",prefixCls:ee}));return At(Gt?T.createElement(g.Z,{component:"Tag"},$t):$t)});nt.CheckableTag=Y;var se=nt},64599:function(oe,$,t){var T=t(96263);function p(Z,P){var A=typeof Symbol!="undefined"&&Z[Symbol.iterator]||Z["@@iterator"];if(!A){if(Array.isArray(Z)||(A=T(Z))||P&&Z&&typeof Z.length=="number"){A&&(Z=A);var i=0,Q=function(){};return{s:Q,n:function(){return i>=Z.length?{done:!0}:{done:!1,value:Z[i++]}},e:function(D){throw D},f:Q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,F=!1,I;return{s:function(){A=A.call(Z)},n:function(){var D=A.next();return g=D.done,D},e:function(D){F=!0,I=D},f:function(){try{!g&&A.return!=null&&A.return()}finally{if(F)throw I}}}}oe.exports=p,oe.exports.__esModule=!0,oe.exports.default=oe.exports}}]);
